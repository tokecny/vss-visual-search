{"ast":null,"code":"var _jsxFileName = \"/Users/pavlov/Documents/GitHub/vss-visual-search/src/pages/game/cjsGame/CJSGame.tsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport './CJSGame.css';\nimport CJSWindow from '../../../components/gameWindow/cjsWindow/CJSWindow';\nimport useSound from 'use-sound';\nimport clickSoundSrc from '../../../assets/sound/click.mp3';\nimport combo2SoundSrc from '../../../assets/sound/combo2.mp3';\nimport losingSoundSrc from '../../../assets/sound/losingStreak.mp3';\nimport moment from 'moment';\nimport { Shuffle } from '../../../scripts/shuffle';\nimport * as vismem from '../../../scripts/vismemCC_simon';\nimport CJSButton from '../../../components/gameWindow/cjsWindow/cjsButton/CJSButton';\nimport { saveJSONDataToClientDevice } from '../../../uitls/offline';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet myCanvas;\nlet canvasContext;\nlet trialNumber;\nlet currTrial = 0;\nlet backgroundColor = '#E5E5E5';\nlet stimulusColor = ['#9370DB', '#3CB4C6', '#B2D33D', '#F67E4B'];\nlet searchTargetList = [[{\n  description: 'สี่เหลี่ยมสีม่วง',\n  color: '#9370DB',\n  shape: 'square'\n}, {\n  description: 'สี่เหลี่ยมสีฟ้า',\n  color: '#3CB4C6',\n  shape: 'square'\n}, {\n  description: 'สี่เหลี่ยมสีเขียว',\n  color: '#B2D33D',\n  shape: 'square'\n}, {\n  description: 'สี่เหลี่ยมสีส้ม',\n  color: '#F67E4B',\n  shape: 'square'\n}], [{\n  description: 'วงกลมสีม่วง',\n  color: '#9370DB',\n  shape: 'circle'\n}, {\n  description: 'วงกลมสีฟ้า',\n  color: '#3CB4C6',\n  shape: 'circle'\n}, {\n  description: 'วงกลมสีเขียว',\n  color: '#B2D33D',\n  shape: 'circle'\n}, {\n  description: 'วงกลมสีส้ม',\n  color: '#F67E4B',\n  shape: 'circle'\n}]];\nlet canvasWidth = 600;\nlet canvasHeight = 600;\nlet squareWidth = 45;\nlet squareHeight = 45;\nlet radius = squareWidth / 2;\nlet positionJitter = 8;\nlet centerX;\nlet centerY;\nlet Xspan = canvasWidth / 2;\nlet Yspan = canvasHeight / 2;\nlet XblockNumber = 8;\nlet YblockNumber = 6;\nlet Xblock = Xspan * 2 / XblockNumber;\nlet Yblock = Yspan * 2 / YblockNumber;\nlet X;\nlet Y;\nlet Xs = [];\nlet Ys = [];\nlet Xtemps = [];\nlet Ytemps = [];\nlet posId = [];\nlet maxSS = Math.floor((XblockNumber * YblockNumber - 1) / 2);\nlet ceilingSS = 0;\nlet currSS = 2;\nlet initialSetSize = 2; // must have same value as currSS\nlet preTestSetsizeAndTarget = [];\nlet postTestSetsizeAndTarget = [];\nlet middleSetsizeAndTarget = [];\nlet allSetsizeAndTarget = [];\nlet change = NaN;\nlet shapeRand = [];\nlet ori;\nlet col;\nlet oris = [];\nlet cols = [];\nlet ceilingTimeLimit = 10 * 1000;\nlet timeLimit = 10 * 1000;\nlet timeLimitDeclineStep = 1000;\nlet timeLimitInclineStep = 500;\nlet checkAns = [];\nlet thatRight = '';\nlet responseText = '';\nlet timeoutList = [];\nlet count = 0;\nlet NupNdown = 5;\nlet trackRecord = 0;\nlet levelUpCount = 0;\nlet STT;\nlet ET;\nlet sumRt = 0;\nlet allRt = [];\nlet sumHitRt;\nlet hitRt = [];\nlet hit2SetSizeRtF = [];\nlet hit6SetSizeRtF = [];\nlet hit12SetSizeRtF = [];\nlet hit24SetSizeRtF = [];\nlet hit44SetSizeRtF = [];\nlet correctRejection2SetSizeRtF = [];\nlet correctRejection6SetSizeRtF = [];\nlet correctRejection12SetSizeRtF = [];\nlet correctRejection24SetSizeRtF = [];\nlet correctRejection44SetSizeRtF = [];\nlet hit2SetSizeRtC = [];\nlet hit6SetSizeRtC = [];\nlet hit12SetSizeRtC = [];\nlet hit24SetSizeRtC = [];\nlet hit44SetSizeRtC = [];\nlet correctRejection2SetSizeRtC = [];\nlet correctRejection6SetSizeRtC = [];\nlet correctRejection12SetSizeRtC = [];\nlet correctRejection24SetSizeRtC = [];\nlet correctRejection44SetSizeRtC = [];\nlet latestHitRtIndex = 0;\nlet correctButLateCount = 0;\nlet lateMultiplier = 10000;\nlet incorrectCount = 0;\nlet incorrectMultiplier = 20000;\nlet scorePerTrial = [0];\nlet sumScores = 0;\nlet scoresMultiplier = 10;\nlet comboCount = [];\nlet rtBound = 10000;\nlet avgHitRt;\nlet avgHit2SetSizeRtF;\nlet avgHit6SetSizeRtF;\nlet avgHit12SetSizeRtF;\nlet avgHit24SetSizeRtF;\nlet avgHit44SetSizeRtF;\nlet avgCorrectRejection2SetSizeRtF;\nlet avgCorrectRejection6SetSizeRtF;\nlet avgCorrectRejection12SetSizeRtF;\nlet avgCorrectRejection24SetSizeRtF;\nlet avgCorrectRejection44SetSizeRtF;\nlet hitAccuracy2SetSizeF;\nlet hitAccuracy6SetSizeF;\nlet hitAccuracy12SetSizeF;\nlet hitAccuracy24SetSizeF;\nlet hitAccuracy44SetSizeF;\nlet correctRejectionAccuracy2SetSizeF;\nlet correctRejectionAccuracy6SetSizeF;\nlet correctRejectionAccuracy12SetSizeF;\nlet correctRejectionAccuracy24SetSizeF;\nlet correctRejectionAccuracy44SetSizeF;\nlet avgHit2SetSizeRtC;\nlet avgHit6SetSizeRtC;\nlet avgHit12SetSizeRtC;\nlet avgHit24SetSizeRtC;\nlet avgHit44SetSizeRtC;\nlet avgCorrectRejection2SetSizeRtC;\nlet avgCorrectRejection6SetSizeRtC;\nlet avgCorrectRejection12SetSizeRtC;\nlet avgCorrectRejection24SetSizeRtC;\nlet avgCorrectRejection44SetSizeRtC;\nlet hitAccuracy2SetSizeC;\nlet hitAccuracy6SetSizeC;\nlet hitAccuracy12SetSizeC;\nlet hitAccuracy24SetSizeC;\nlet hitAccuracy44SetSizeC;\nlet correctRejectionAccuracy2SetSizeC;\nlet correctRejectionAccuracy6SetSizeC;\nlet correctRejectionAccuracy12SetSizeC;\nlet correctRejectionAccuracy24SetSizeC;\nlet correctRejectionAccuracy44SetSizeC;\nlet swiftness = '';\nlet total = 0;\nlet score;\nlet targetMatch = [];\nlet allStartTime = [];\nlet allClickTime = [];\nlet allCurrSS = [];\nlet gameLogicSchemeResult;\nlet trialDataResult = [];\nlet stimulusDataResult = [];\nlet targetDataResult;\nlet scoringDataResult = [];\nlet timeLimitRecord = [];\nlet setSizeRecord = [];\nlet setSizeInCorrectAns = [];\nlet metricDataResult = [];\nlet allSearchMode = [];\nlet postEntryResult;\nfunction CJSGame(props) {\n  _s();\n  const navigate = useNavigate();\n  const [clickSound] = useSound(clickSoundSrc);\n  const [combo2Sound] = useSound(combo2SoundSrc);\n  const [losingSound] = useSound(losingSoundSrc);\n  const [searchTarget, setSearchTarget] = useState();\n  const [progressValue, setProgressValue] = useState(0);\n  const [disabledButton, setDisabledButton] = useState(false);\n  const [isItDone, setIsItDone] = useState(false);\n  const [colorSet, setColorSet] = useState(props.userId % 4);\n  useEffect(() => {\n    initiateData();\n    // have to set search target before switchSearchMode() & createTargetCanvas() \n    checkStimuliColorSet();\n    createPseudorandomStimuli();\n    gameLogicSchemeResult = gameLogicScheme(trialNumber, backgroundColor, squareWidth, radius, stimulusColor, positionJitter, XblockNumber, YblockNumber, ceilingTimeLimit, timeLimitDeclineStep, timeLimitInclineStep, canvasHeight, canvasWidth, initialSetSize);\n    return () => {\n      timeoutList.forEach(tm => {\n        clearTimeout(tm);\n      });\n    };\n  }, []);\n  useEffect(() => {\n    switchSearchMode();\n  }, [searchTarget]);\n  function gameLogicScheme(trialNumber, backgroundColor, squareWidth, radius, stimulusColor, positionJitter, XblockNumber, YblockNumber, ceilingTimeLimit, timeLimitDeclineStep, timeLimitInclineStep, canvasHeight, canvasWidth, initialSetSize) {\n    gameLogicSchemeResult = {\n      \"game\": \"face-in-the-crowd \",\n      \"schemeName\": \"default\",\n      \"version\": \"1.0\",\n      \"variant\": \"main\",\n      \"parameters\": {\n        \"trialNumber\": {\n          \"value\": trialNumber,\n          \"unit\": null,\n          \"description\": \"Total number of trials\"\n        },\n        \"backgroundColor\": {\n          \"value\": backgroundColor,\n          \"unit\": null,\n          \"description\": \"Background color of test canvas\"\n        },\n        \"stimulusShape\": {\n          \"value\": [{\n            \"shapeName\": \"square\",\n            \"parameters\": {\n              \"squareWidth\": {\n                \"value\": squareWidth,\n                \"unit\": \"px\",\n                \"description\": \"Square stimulus width\"\n              }\n            },\n            \"description\": \"Square stimulus\"\n          }, {\n            \"shapeName\": \"circle\",\n            \"parameters\": {\n              \"radius\": {\n                \"value\": radius,\n                \"unit\": \"px\",\n                \"description\": \"Circle stimulus radius\"\n              }\n            },\n            \"description\": \"Circle stimulus\"\n          }],\n          \"unit\": null,\n          \"description\": \"Set of possible stimulus shape\"\n        },\n        \"stimulusColor\": {\n          \"value\": stimulusColor,\n          \"unit\": null,\n          \"description\": \"Set of possible stimulus color\"\n        },\n        \"positionJitter\": {\n          \"value\": positionJitter,\n          \"unit\": \"px\",\n          \"description\": \"Amplitude of spatial jittering in each axis\"\n        },\n        \"XblockNumber\": {\n          \"value\": XblockNumber,\n          \"unit\": null,\n          \"description\": \"Number of horizontal blocks composing the canvas\"\n        },\n        \"YblockNumber\": {\n          \"value\": YblockNumber,\n          \"unit\": null,\n          \"description\": \"Number of vertical blocks composing the canvas\"\n        },\n        \"canvasProperty\": {\n          \"canvasHeight\": {\n            \"value\": canvasHeight,\n            \"unit\": \"px\",\n            \"description\": \"Height of canvas\"\n          },\n          \"canvasWidth\": {\n            \"value\": canvasWidth,\n            \"unit\": \"px\",\n            \"description\": \"Width of canvas\"\n          }\n        },\n        \"initialSetSize\": {\n          \"value\": initialSetSize,\n          \"unit\": null,\n          \"description\": \"Initial set size\"\n        }\n      },\n      \"description\": \"Conjunction search default scheme\"\n    };\n    return gameLogicSchemeResult;\n  }\n  function initiateData() {\n    hitRt = [];\n    allRt = [];\n    currSS = 2;\n    ceilingSS = 0;\n    latestHitRtIndex = 0;\n    comboCount = [];\n    correctButLateCount = 0;\n    incorrectCount = 0;\n    count = 0;\n    currTrial = 0;\n    Xtemps = [];\n    Xs = [];\n    Ytemps = [];\n    Ys = [];\n    posId = [];\n  }\n  function checkStimuliColorSet() {\n    if (props.userId % 2 === 0) {\n      // ถ้า userId เป็นเลขคู่\n      if (window.location.href.includes('face-in-the-crowd-A')) {\n        setSearchTarget({\n          shape: 0,\n          col: colorSet\n        });\n      } else {\n        setSearchTarget({\n          shape: 1,\n          col: (colorSet + 1) % 4\n        });\n      }\n    } else {\n      // ถ้า userId เป็นเลขคี่\n      if (window.location.href.includes('face-in-the-crowd-A')) {\n        setSearchTarget({\n          shape: 1,\n          col: colorSet\n        });\n      } else {\n        setSearchTarget({\n          shape: 0,\n          col: (colorSet + 1) % 4\n        });\n      }\n    }\n  }\n  function createPseudorandomStimuli() {\n    preTestSetsizeAndTarget = [];\n    postTestSetsizeAndTarget = [];\n    middleSetsizeAndTarget = [];\n    allSetsizeAndTarget = [];\n    let allSetsizeRange = [31];\n    let trialsPerSetsize = 60;\n    let targetCondition = 2; // target appear or disappear\n    let trialsPerCondition = trialsPerSetsize / targetCondition;\n    let searchMode = 2; // feature or conjunction \n    let miniBlocks = 6; // in middle blocks \n    let trialsPerBlock = trialsPerSetsize / miniBlocks; // จำนวน trials ต่อ mini-block\n    let probabilities = [1.0, 0.8, 0.6, 0.4, 0.2, 0.0]; // โอกาสการปรากฏของ 1 ในแต่ละ mini-block\n\n    // conjunction search pre-test and post-test\n    for (let iSetsize = 0; iSetsize < allSetsizeRange.length; iSetsize++) {\n      for (let iRep = 0; iRep < trialsPerCondition; iRep++) {\n        for (let iTarget = 0; iTarget < targetCondition; iTarget++) {\n          preTestSetsizeAndTarget.push([allSetsizeRange[iSetsize], iTarget, 1]);\n          postTestSetsizeAndTarget.push([allSetsizeRange[iSetsize], iTarget, 1]);\n        }\n      }\n    }\n    Shuffle(preTestSetsizeAndTarget);\n    Shuffle(postTestSetsizeAndTarget);\n\n    // รวม preTestSetsizeAndTarget กับ postTestSetsizeAndTarget เข้าด้วยกัน\n    allSetsizeAndTarget = [...preTestSetsizeAndTarget, ...postTestSetsizeAndTarget];\n    if (window.location.href.includes('face-in-the-crowd-A')) {\n      probabilities = [1.0, 0.8, 0.6, 0.4, 0.2, 0.0];\n    } else {\n      probabilities.reverse();\n    }\n\n    // feature search + conjunction search 6 mini-blocks \n    // ก่อนจะแทรก middleSetsizeAndTarget เช็คให้ชัวร์ก่อนว่า allSetsizeAndTarget มีครบทั้ง pre และ post-test\n    if (allSetsizeAndTarget.length === preTestSetsizeAndTarget.length + postTestSetsizeAndTarget.length) {\n      probabilities.slice(0, miniBlocks).forEach(probability => {\n        const targetAppear = Math.round(trialsPerBlock * probability); // จำนวนครั้งที่ต้อง push 1\n        const targetAbsent = trialsPerBlock - targetAppear; // ที่เหลือเป็น 0\n\n        // สร้าง array ที่มี 1 และ 0 ตามจำนวนที่คำนวณ ของ feature search\n        const featureArray = Array(targetAppear).fill(1).concat(Array(targetAbsent).fill(0));\n\n        // สร้าง array ที่มี 1 และ 0 ตามจำนวนที่คำนวณ ของ conjunction search (0 และ 1 อย่างละครึ่ง)\n        const conjunctionArray = Array(trialsPerBlock / 2).fill(0).concat(Array(trialsPerBlock / 2).fill(1));\n\n        // สุ่มให้คละกัน\n        Shuffle(featureArray);\n        Shuffle(conjunctionArray);\n        for (let iSetsize = 0; iSetsize < allSetsizeRange.length; iSetsize++) {\n          for (let iTarget = 0; iTarget < featureArray.length; iTarget++) {\n            middleSetsizeAndTarget.push([allSetsizeRange[iSetsize], featureArray[iTarget], 0]);\n          }\n          for (let iTarget = 0; iTarget < conjunctionArray.length; iTarget++) {\n            middleSetsizeAndTarget.push([allSetsizeRange[iSetsize], conjunctionArray[iTarget], 1]);\n          }\n        }\n      });\n\n      // หา index ตรงกลางของ allSetsizeAndTarget เพื่อแทรก middleSetsizeAndTarget เข้าไป\n      const middleIndex = Math.floor(allSetsizeAndTarget.length / 2); // ตำแหน่งกลางของ array\n      allSetsizeAndTarget.splice(middleIndex, 0, ...middleSetsizeAndTarget);\n    }\n\n    // กำหนดค่า trialNumber ให้เท่ากับจำนวนข้อทั้งหมด\n    trialNumber = allSetsizeAndTarget.length;\n    console.log(trialNumber);\n  }\n  function switchSearchMode() {\n    if (searchTarget) {\n      oris = [];\n      cols = [];\n      if (allSetsizeAndTarget[currTrial][2] === 0) {\n        // feature search\n        allSearchMode.push('feature search');\n        for (let j = 0; j < maxSS; j++) {\n          oris.push(0);\n          oris.push(0);\n        }\n        ;\n        if (searchTarget.shape === 1) {\n          shapeRand = [1];\n        } else {\n          shapeRand = [0];\n        }\n        if (searchTarget.col === 0) {\n          for (let k = 0; k < maxSS; k++) {\n            cols.push(2);\n            cols.push(2);\n          }\n          ;\n        } else if (searchTarget.col === 1) {\n          for (let k = 0; k < maxSS; k++) {\n            cols.push(3);\n            cols.push(3);\n          }\n          ;\n        } else if (searchTarget.col === 2) {\n          for (let k = 0; k < maxSS; k++) {\n            cols.push(0);\n            cols.push(0);\n          }\n          ;\n        } else if (searchTarget.col === 3) {\n          for (let k = 0; k < maxSS; k++) {\n            cols.push(1);\n            cols.push(1);\n          }\n          ;\n        }\n      } else {\n        // conjunction search\n        allSearchMode.push('conjunction search');\n        for (let j = 0; j < maxSS; j++) {\n          oris.push(0);\n          oris.push(1);\n        }\n        ;\n        if (searchTarget.col === 0) {\n          for (let k = 0; k < maxSS; k++) {\n            cols.push(0);\n            cols.push(2);\n          }\n          ;\n        } else if (searchTarget.col === 1) {\n          for (let k = 0; k < maxSS; k++) {\n            cols.push(1);\n            cols.push(3);\n          }\n          ;\n        } else if (searchTarget.col === 2) {\n          for (let k = 0; k < maxSS; k++) {\n            cols.push(2);\n            cols.push(0);\n          }\n          ;\n        } else if (searchTarget.col === 3) {\n          for (let k = 0; k < maxSS; k++) {\n            cols.push(3);\n            cols.push(1);\n          }\n          ;\n        }\n        if (searchTarget.shape === 1) {\n          shapeRand = [1];\n        } else {\n          shapeRand = [0];\n        }\n      }\n\n      // if createCanvas() runs before switchSearchMode() the target and distractors position might be overlapped\n      if (currTrial === 0) {\n        // create only one time when the game started\n        createCanvas();\n      }\n      initialT(0, allSetsizeAndTarget[currTrial][0]);\n    }\n  }\n  function createCanvas() {\n    myCanvas = document.getElementById(\"myCanvas\");\n    canvasContext = myCanvas.getContext(\"2d\");\n    centerX = myCanvas.width / 2;\n    centerY = myCanvas.height / 2;\n    for (var ix = 0; ix < XblockNumber; ix++) {\n      Xtemps.push(Math.round(Xblock / 2) + Xblock * ix - Xspan + centerX);\n    }\n    for (var iy = 0; iy < YblockNumber; iy++) {\n      Ytemps.push(Math.round(Yblock / 2) + Yblock * iy - Yspan + centerY);\n    }\n    for (ix = 0; ix < XblockNumber; ix++) {\n      for (iy = 0; iy < YblockNumber; iy++) {\n        Xs.push(Xtemps[ix]);\n        Ys.push(Ytemps[iy]);\n        posId.push(count);\n        count++;\n      }\n    }\n    myCanvas.hidden = false;\n  }\n  function initialT(_waittime, SS) {\n    setDisabledButton(false);\n    setSizeRecord.push(SS);\n    timeLimitRecord.push(timeLimit);\n    if (!ceilingSS) {\n      ceilingSS = SS + 1;\n    }\n    ;\n    vismem.erase(canvasContext);\n    vismem.clear();\n    allCurrSS.push(allSetsizeAndTarget[currTrial][0]);\n    shuffleSS(SS);\n    targetData(squareWidth, ori, col);\n    makeBackground(backgroundColor);\n    makeSearchArray(X, Y, squareWidth, squareHeight, ori, col);\n    stimulusData(realX, realY, squareWidth, ori, col);\n    vismem.drawObjects(canvasContext, vismem.objects);\n    let dT = new Date();\n    STT = dT.getTime();\n    allStartTime.push(thisTime());\n  }\n  function shuffleSS(setSize) {\n    Shuffle(posId);\n    X = [];\n    for (let ix = 0; ix < setSize + 1; ix++) {\n      X.push(Xs[posId[ix]]);\n    }\n    ;\n    Y = [];\n    for (let iy = 0; iy < setSize + 1; iy++) {\n      Y.push(Ys[posId[iy]]);\n    }\n    ;\n    ori = [];\n    for (let j = 0; j < setSize; j++) {\n      ori.push(oris[j]);\n    }\n    ;\n    col = [];\n    for (let j = 0; j < setSize; j++) {\n      col.push(stimulusColor[cols[j]]);\n    }\n    ;\n\n    // check if this trial is feature or conjunction search\n    if (allSetsizeAndTarget[currTrial][2] === 0) {\n      // feature search\n      // check if the target appears or disappears\n      if (allSetsizeAndTarget[currTrial][1] === 0) {\n        // disappears\n        ori.push(oris[setSize]);\n        col.push(stimulusColor[cols[setSize]]);\n      } else {\n        // appears\n        if (oris[setSize] === 0) {\n          ori.push(1);\n        } else {\n          ori.push(1);\n        }\n        if (cols[setSize] === 0) {\n          col.push(stimulusColor[2]);\n        } else if (cols[setSize] === 1) {\n          col.push(stimulusColor[3]);\n        } else if (cols[setSize] === 2) {\n          col.push(stimulusColor[0]);\n        } else if (cols[setSize] === 3) {\n          col.push(stimulusColor[1]);\n        }\n      }\n    } else {\n      // conjunction search\n      // check if the target appears or disappears\n      if (allSetsizeAndTarget[currTrial][1] === 0) {\n        // disappears\n        ori.push(oris[setSize]);\n        col.push(stimulusColor[cols[setSize]]);\n      } else {\n        // appears\n        if (oris[setSize] === 0) {\n          ori.push(1);\n        } else {\n          ori.push(1);\n        }\n        if (cols[setSize] === 0) {\n          col.push(stimulusColor[2]);\n        } else if (cols[setSize] === 1) {\n          col.push(stimulusColor[3]);\n        } else if (cols[setSize] === 2) {\n          col.push(stimulusColor[0]);\n        } else if (cols[setSize] === 3) {\n          col.push(stimulusColor[1]);\n        }\n      }\n    }\n  }\n  function makeBackground(backgroundColor) {\n    // Fill background\n    vismem.makeRectangle('bg', centerX, centerY, canvasWidth, canvasHeight, false, backgroundColor, backgroundColor);\n  }\n  let realX = [];\n  let realY = [];\n  function makeSearchArray(numarrayX, numarrayY, squareWidth, squareHeight, orienVec, colorVec) {\n    for (let i = 0; i < orienVec.length; i++) {\n      if (orienVec[i] === shapeRand[0]) {\n        vismem.makeCircle('c', numarrayX[i] + (Math.random() - 0.5) * 2 * positionJitter, numarrayY[i] + (Math.random() - 0.5) * 2 * positionJitter, radius, false, colorVec[i], colorVec[i]);\n      } else {\n        vismem.makeRectangle('s', numarrayX[i] + (Math.random() - 0.5) * 2 * positionJitter, numarrayY[i] + (Math.random() - 0.5) * 2 * positionJitter, squareHeight, squareWidth, false, colorVec[i], colorVec[i], 0, 0);\n      }\n      realX.push(numarrayX[i] + (Math.random() - 0.5) * 2 * positionJitter);\n      realY.push(numarrayY[i] + (Math.random() - 0.5) * 2 * positionJitter);\n    }\n    if (searchTarget) {\n      // Find Target from Object\n      let find = vismem.objects.find(x => x.id === (searchTarget.shape === 0 ? 's' : 'c') && x.color === stimulusColor[searchTarget.col]);\n      change = find ? 1 : 0;\n      targetMatch.push(find ? true : false);\n    }\n  }\n  function targetData(width, ori, col) {\n    let thisShape = \"\";\n    let thisParameterName = \"\";\n    let thisValue = 0;\n    let obj_in_trial = [];\n    let obj_to_append;\n    if (shapeRand[0] === 1) {\n      thisShape = \"circle\";\n      thisParameterName = \"radius\";\n      thisValue = radius;\n    } else {\n      thisShape = \"square\";\n      thisParameterName = \"width\";\n      thisValue = width;\n    }\n    if (searchTarget) {\n      obj_to_append = {\n        \"shape\": thisShape,\n        \"shapeParams\": {\n          \"parameterName\": thisParameterName,\n          \"value\": thisValue,\n          \"unit\": \"px\"\n        },\n        \"color\": stimulusColor[searchTarget.col]\n      };\n      obj_in_trial.push(obj_to_append);\n    }\n    targetDataResult = obj_in_trial[obj_in_trial.length - 1];\n    return targetDataResult;\n  }\n  function stimulusData(x, y, width, ori, col) {\n    let thisShape = \"\";\n    let thisParameterName = \"\";\n    let thisValue = 0;\n    let obj_in_trial = [];\n    for (let i = 0; i < col.length; i++) {\n      let obj_to_append;\n      if (ori[i] === shapeRand[0]) {\n        thisShape = \"circle\";\n        thisParameterName = \"radius\";\n        thisValue = radius;\n      } else {\n        thisShape = \"square\";\n        thisParameterName = \"width\";\n        thisValue = width;\n      }\n      obj_to_append = {\n        \"type\": \"distractor\",\n        \"display\": {\n          \"shape\": thisShape,\n          \"shapeParams\": {\n            \"parameterName\": thisParameterName,\n            \"value\": thisValue,\n            \"unit\": \"px\"\n          },\n          \"color\": col[i]\n        },\n        \"position\": {\n          \"x\": {\n            \"value\": x[i],\n            \"unit\": \"px\"\n          },\n          \"y\": {\n            \"value\": y[i],\n            \"unit\": \"px\"\n          }\n        }\n      };\n      obj_in_trial.push(obj_to_append);\n    }\n    obj_in_trial[obj_in_trial.length - 1].type = \"target\";\n    stimulusDataResult.push(obj_in_trial);\n    return stimulusDataResult;\n  }\n  function trialData(targetMatch, allStartTime, allCurrSS, allClickTime, checkAns, stimulusDataResult, allSearchMode) {\n    let thisAns;\n    let obj_in_trial = [];\n    for (let i = 0; i < targetMatch.length; i++) {\n      let obj_to_append;\n      if (checkAns[i] === 'right' || checkAns[i] === 'late') {\n        thisAns = true;\n      } else {\n        thisAns = false;\n      }\n      obj_to_append = {\n        \"hasTarget\": targetMatch[i],\n        \"startTime\": allStartTime[i],\n        \"setSize\": allCurrSS[i],\n        \"answerTime\": allClickTime[i],\n        \"hasTargetAnswerBool\": thisAns,\n        \"stimulusData\": stimulusDataResult[i],\n        \"mode\": allSearchMode[i]\n      };\n      obj_in_trial.push(obj_to_append);\n    }\n    trialDataResult.push(obj_in_trial[obj_in_trial.length - 1]);\n    return trialDataResult;\n  }\n  function checkResp(foo) {\n    setProgressValue(progressValue + 1);\n    clickSound();\n    let dT2 = new Date();\n    ET = dT2.getTime();\n    allClickTime.push(thisTime());\n    let rt = ET - STT;\n    allRt.push(rt);\n    if (change === foo) {\n      combo2Sound();\n      if (rt < timeLimit) {\n        trackRecord = trackRecord + 1;\n        thatRight = 'right';\n        checkAns.push(thatRight);\n        hitRt.push(rt);\n        if (levelUpCount === 0) {\n          comboCount.push(0);\n        } else if (levelUpCount === 1) {\n          comboCount.push(1);\n        } else if (levelUpCount === 2) {\n          comboCount.push(2);\n        } else if (levelUpCount === 3) {\n          comboCount.push(3);\n        } else if (levelUpCount === 4) {\n          comboCount.push(4);\n        } else if (levelUpCount === 5) {\n          comboCount.push(5);\n        }\n      } else {\n        combo2Sound();\n        thatRight = 'late';\n        trackRecord = 0;\n        checkAns.push(thatRight);\n        correctButLateCount++;\n      }\n\n      // check if feature or conjunction mode\n      if (allSetsizeAndTarget[currTrial][2] === 0) {\n        // feature\n        // check if target appear or disappear\n        if (allSetsizeAndTarget[currTrial][1] === 0) {\n          // disappear\n          // check setsize that correct rejection\n          if (allSetsizeAndTarget[currTrial][0] === 2) {\n            correctRejection2SetSizeRtF.push(rt);\n          } else if (allSetsizeAndTarget[currTrial][0] === 6) {\n            correctRejection6SetSizeRtF.push(rt);\n          } else if (allSetsizeAndTarget[currTrial][0] === 12) {\n            correctRejection12SetSizeRtF.push(rt);\n          } else if (allSetsizeAndTarget[currTrial][0] === 24) {\n            correctRejection24SetSizeRtF.push(rt);\n          } else if (allSetsizeAndTarget[currTrial][0] === 44) {\n            correctRejection44SetSizeRtF.push(rt);\n          }\n        } else {\n          // appear\n          // check setsize that hit\n          if (allSetsizeAndTarget[currTrial][0] === 2) {\n            hit2SetSizeRtF.push(rt);\n          } else if (allSetsizeAndTarget[currTrial][0] === 6) {\n            hit6SetSizeRtF.push(rt);\n          } else if (allSetsizeAndTarget[currTrial][0] === 12) {\n            hit12SetSizeRtF.push(rt);\n          } else if (allSetsizeAndTarget[currTrial][0] === 24) {\n            hit24SetSizeRtF.push(rt);\n          } else if (allSetsizeAndTarget[currTrial][0] === 44) {\n            hit44SetSizeRtF.push(rt);\n          }\n        }\n      } else {\n        // conjunction\n        // check if target appear or disappear\n        if (allSetsizeAndTarget[currTrial][1] === 0) {\n          // disappear\n          // check setsize that correct rejection\n          if (allSetsizeAndTarget[currTrial][0] === 2) {\n            correctRejection2SetSizeRtC.push(rt);\n          } else if (allSetsizeAndTarget[currTrial][0] === 6) {\n            correctRejection6SetSizeRtC.push(rt);\n          } else if (allSetsizeAndTarget[currTrial][0] === 12) {\n            correctRejection12SetSizeRtC.push(rt);\n          } else if (allSetsizeAndTarget[currTrial][0] === 24) {\n            correctRejection24SetSizeRtC.push(rt);\n          } else if (allSetsizeAndTarget[currTrial][0] === 44) {\n            correctRejection44SetSizeRtC.push(rt);\n          }\n        } else {\n          // appear\n          // check setsize that hit\n          if (allSetsizeAndTarget[currTrial][0] === 2) {\n            hit2SetSizeRtC.push(rt);\n          } else if (allSetsizeAndTarget[currTrial][0] === 6) {\n            hit6SetSizeRtC.push(rt);\n          } else if (allSetsizeAndTarget[currTrial][0] === 12) {\n            hit12SetSizeRtC.push(rt);\n          } else if (allSetsizeAndTarget[currTrial][0] === 24) {\n            hit24SetSizeRtC.push(rt);\n          } else if (allSetsizeAndTarget[currTrial][0] === 44) {\n            hit44SetSizeRtC.push(rt);\n          }\n        }\n      }\n    } else {\n      losingSound();\n      thatRight = 'wrong';\n      trackRecord = 0;\n      checkAns.push(thatRight);\n      incorrectCount++;\n    }\n    trialDataResult = trialData(targetMatch, allStartTime, allCurrSS, allClickTime, checkAns, stimulusDataResult, allSearchMode);\n    trialIsOver();\n  }\n  function trialIsOver() {\n    vismem.erase(canvasContext);\n    vismem.clear();\n    makeBackground(backgroundColor);\n    vismem.drawObjects(canvasContext, vismem.objects);\n    if (trackRecord >= NupNdown) {\n      if (allSetsizeAndTarget[currTrial][0] < maxSS * 2 - 2) {\n        // currSS = currSS + 2;\n        ceilingSS = allSetsizeAndTarget[currTrial][0] + 1;\n        if (levelUpCount === 5) {\n          levelUpCount = 5;\n        } else {\n          levelUpCount++;\n        }\n      } else {\n        ceilingSS = allSetsizeAndTarget[currTrial][0] + 1;\n        timeLimit = timeLimit - timeLimitDeclineStep;\n      }\n    }\n    if (trackRecord === 0 && allSetsizeAndTarget[currTrial][0] > 4) {\n      // currSS = currSS - 2;\n      timeLimit = timeLimit + timeLimitInclineStep;\n      if (timeLimit > ceilingTimeLimit) {\n        timeLimit = ceilingTimeLimit;\n      }\n    }\n    currTrial = currTrial + 1;\n    if (currTrial >= trialNumber) {\n      summarySetSize();\n      summaryScore();\n      Done();\n    } else {\n      trialConclude();\n    }\n  }\n  function trialConclude() {\n    setDisabledButton(true);\n    vismem.erase(canvasContext);\n    vismem.clear();\n    makeBackground(backgroundColor);\n    vismem.drawObjects(canvasContext, vismem.objects);\n    let textHeight = 0;\n    if (thatRight === 'wrong') {\n      responseText = \"ผิด\";\n      textHeight = 36;\n    } else {\n      responseText = \"ถูก\";\n      textHeight = 20;\n    }\n    canvasContext.font = \"120px Sarabun\";\n    let textWidth = canvasContext.measureText(responseText).width;\n    timeoutList.push(setTimeout(function () {\n      let text = vismem.makeText('t', centerX - textWidth / 2, centerY + textHeight, responseText, \"Black\", canvasContext.font);\n      vismem.drawText(canvasContext, text);\n    }, 100), setTimeout(function () {\n      vismem.erase(canvasContext);\n      vismem.clear();\n      makeBackground(backgroundColor);\n      vismem.drawObjects(canvasContext, vismem.objects);\n    }, 600), setTimeout(function () {\n      switchSearchMode();\n    }, 900));\n  }\n  function summarySetSize() {\n    let sumHit2SetSizeRtF;\n    let sumHit6SetSizeRtF;\n    let sumHit12SetSizeRtF;\n    let sumHit24SetSizeRtF;\n    let sumHit44SetSizeRtF;\n    let sumCorrectRejection2SetSizeRtF;\n    let sumCorrectRejection6SetSizeRtF;\n    let sumCorrectRejection12SetSizeRtF;\n    let sumCorrectRejection24SetSizeRtF;\n    let sumCorrectRejection44SetSizeRtF;\n    let sumHit2SetSizeRtC;\n    let sumHit6SetSizeRtC;\n    let sumHit12SetSizeRtC;\n    let sumHit24SetSizeRtC;\n    let sumHit44SetSizeRtC;\n    let sumCorrectRejection2SetSizeRtC;\n    let sumCorrectRejection6SetSizeRtC;\n    let sumCorrectRejection12SetSizeRtC;\n    let sumCorrectRejection24SetSizeRtC;\n    let sumCorrectRejection44SetSizeRtC;\n    let featureOrConjunctionCondition = 2; // feature or conjunction\n    let appearOrDisappearCondition = 2; // appear or disappear\n    let setSizeCondition = 5; // [2, 6, 12, 24, 44] setsize\n    let trialNumberPerCondition = allSetsizeAndTarget.length / (featureOrConjunctionCondition * appearOrDisappearCondition * setSizeCondition);\n\n    // feature section\n    // 2 setsize section\n    hitAccuracy2SetSizeF = hit2SetSizeRtF.length / trialNumberPerCondition * 100;\n    if (hit2SetSizeRtF.length !== 0) {\n      sumHit2SetSizeRtF = hit2SetSizeRtF.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      hit2SetSizeRtF.push(0);\n      sumHit2SetSizeRtF = hit2SetSizeRtF;\n    }\n    avgHit2SetSizeRtF = sumHit2SetSizeRtF / 1000 / hit2SetSizeRtF.length;\n    correctRejectionAccuracy2SetSizeF = correctRejection2SetSizeRtF.length / trialNumberPerCondition * 100;\n    if (correctRejection2SetSizeRtF.length !== 0) {\n      sumCorrectRejection2SetSizeRtF = correctRejection2SetSizeRtF.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      correctRejection2SetSizeRtF.push(0);\n      sumCorrectRejection2SetSizeRtF = correctRejection2SetSizeRtF;\n    }\n    avgCorrectRejection2SetSizeRtF = sumCorrectRejection2SetSizeRtF / 1000 / correctRejection2SetSizeRtF.length;\n\n    // 6 setsize section\n    hitAccuracy6SetSizeF = hit6SetSizeRtF.length / trialNumberPerCondition * 100;\n    if (hit6SetSizeRtF.length !== 0) {\n      sumHit6SetSizeRtF = hit6SetSizeRtF.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      hit6SetSizeRtF.push(0);\n      sumHit6SetSizeRtF = hit6SetSizeRtF;\n    }\n    avgHit6SetSizeRtF = sumHit6SetSizeRtF / 1000 / hit6SetSizeRtF.length;\n    correctRejectionAccuracy6SetSizeF = correctRejection6SetSizeRtF.length / trialNumberPerCondition * 100;\n    if (correctRejection6SetSizeRtF.length !== 0) {\n      sumCorrectRejection6SetSizeRtF = correctRejection6SetSizeRtF.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      correctRejection6SetSizeRtF.push(0);\n      sumCorrectRejection6SetSizeRtF = correctRejection6SetSizeRtF;\n    }\n    avgCorrectRejection6SetSizeRtF = sumCorrectRejection6SetSizeRtF / 1000 / correctRejection6SetSizeRtF.length;\n\n    // 12 setsize section\n    hitAccuracy12SetSizeF = hit12SetSizeRtF.length / trialNumberPerCondition * 100;\n    if (hit12SetSizeRtF.length !== 0) {\n      sumHit12SetSizeRtF = hit12SetSizeRtF.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      hit12SetSizeRtF.push(0);\n      sumHit12SetSizeRtF = hit2SetSizeRtF;\n    }\n    avgHit12SetSizeRtF = sumHit12SetSizeRtF / 1000 / hit12SetSizeRtF.length;\n    correctRejectionAccuracy12SetSizeF = correctRejection12SetSizeRtF.length / trialNumberPerCondition * 100;\n    if (correctRejection12SetSizeRtF.length !== 0) {\n      sumCorrectRejection12SetSizeRtF = correctRejection12SetSizeRtF.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      correctRejection12SetSizeRtF.push(0);\n      sumCorrectRejection12SetSizeRtF = correctRejection12SetSizeRtF;\n    }\n    avgCorrectRejection12SetSizeRtF = sumCorrectRejection12SetSizeRtF / 1000 / correctRejection12SetSizeRtF.length;\n\n    // 24 setsize section\n    hitAccuracy24SetSizeF = hit24SetSizeRtF.length / trialNumberPerCondition * 100;\n    if (hit24SetSizeRtF.length !== 0) {\n      sumHit24SetSizeRtF = hit24SetSizeRtF.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      hit24SetSizeRtF.push(0);\n      sumHit24SetSizeRtF = hit24SetSizeRtF;\n    }\n    avgHit24SetSizeRtF = sumHit24SetSizeRtF / 1000 / hit24SetSizeRtF.length;\n    correctRejectionAccuracy24SetSizeF = correctRejection24SetSizeRtF.length / trialNumberPerCondition * 100;\n    if (correctRejection24SetSizeRtF.length !== 0) {\n      sumCorrectRejection24SetSizeRtF = correctRejection24SetSizeRtF.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      correctRejection24SetSizeRtF.push(0);\n      sumCorrectRejection24SetSizeRtF = correctRejection24SetSizeRtF;\n    }\n    avgCorrectRejection24SetSizeRtF = sumCorrectRejection24SetSizeRtF / 1000 / correctRejection24SetSizeRtF.length;\n\n    // 44 setsize section\n    hitAccuracy44SetSizeF = hit44SetSizeRtF.length / trialNumberPerCondition * 100;\n    if (hit44SetSizeRtF.length !== 0) {\n      sumHit44SetSizeRtF = hit44SetSizeRtF.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      hit44SetSizeRtF.push(0);\n      sumHit44SetSizeRtF = hit44SetSizeRtF;\n    }\n    avgHit44SetSizeRtF = sumHit44SetSizeRtF / 1000 / hit44SetSizeRtF.length;\n    correctRejectionAccuracy44SetSizeF = correctRejection44SetSizeRtF.length / trialNumberPerCondition * 100;\n    if (correctRejection44SetSizeRtF.length !== 0) {\n      sumCorrectRejection44SetSizeRtF = correctRejection44SetSizeRtF.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      correctRejection44SetSizeRtF.push(0);\n      sumCorrectRejection44SetSizeRtF = correctRejection44SetSizeRtF;\n    }\n    avgCorrectRejection44SetSizeRtF = sumCorrectRejection44SetSizeRtF / 1000 / correctRejection44SetSizeRtF.length;\n\n    // conjunction section\n    // 2 setsize section\n    hitAccuracy2SetSizeC = hit2SetSizeRtC.length / trialNumberPerCondition * 100;\n    if (hit2SetSizeRtC.length !== 0) {\n      sumHit2SetSizeRtC = hit2SetSizeRtC.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      hit2SetSizeRtC.push(0);\n      sumHit2SetSizeRtC = hit2SetSizeRtC;\n    }\n    avgHit2SetSizeRtC = sumHit2SetSizeRtC / 1000 / hit2SetSizeRtC.length;\n    correctRejectionAccuracy2SetSizeC = correctRejection2SetSizeRtC.length / trialNumberPerCondition * 100;\n    if (correctRejection2SetSizeRtC.length !== 0) {\n      sumCorrectRejection2SetSizeRtC = correctRejection2SetSizeRtC.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      correctRejection2SetSizeRtC.push(0);\n      sumCorrectRejection2SetSizeRtC = correctRejection2SetSizeRtC;\n    }\n    avgCorrectRejection2SetSizeRtC = sumCorrectRejection2SetSizeRtC / 1000 / correctRejection2SetSizeRtC.length;\n\n    // 6 setsize section\n    hitAccuracy6SetSizeC = hit6SetSizeRtC.length / trialNumberPerCondition * 100;\n    if (hit6SetSizeRtC.length !== 0) {\n      sumHit6SetSizeRtC = hit6SetSizeRtC.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      hit6SetSizeRtC.push(0);\n      sumHit6SetSizeRtC = hit6SetSizeRtC;\n    }\n    avgHit6SetSizeRtC = sumHit6SetSizeRtC / 1000 / hit6SetSizeRtC.length;\n    correctRejectionAccuracy6SetSizeC = correctRejection6SetSizeRtC.length / trialNumberPerCondition * 100;\n    if (correctRejection6SetSizeRtC.length !== 0) {\n      sumCorrectRejection6SetSizeRtC = correctRejection6SetSizeRtC.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      correctRejection6SetSizeRtC.push(0);\n      sumCorrectRejection6SetSizeRtC = correctRejection6SetSizeRtC;\n    }\n    avgCorrectRejection6SetSizeRtC = sumCorrectRejection6SetSizeRtC / 1000 / correctRejection6SetSizeRtC.length;\n\n    // 12 setsize section\n    hitAccuracy12SetSizeC = hit12SetSizeRtC.length / trialNumberPerCondition * 100;\n    if (hit12SetSizeRtC.length !== 0) {\n      sumHit12SetSizeRtC = hit12SetSizeRtC.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      hit12SetSizeRtC.push(0);\n      sumHit12SetSizeRtC = hit2SetSizeRtC;\n    }\n    avgHit12SetSizeRtC = sumHit12SetSizeRtC / 1000 / hit12SetSizeRtC.length;\n    correctRejectionAccuracy12SetSizeC = correctRejection12SetSizeRtC.length / trialNumberPerCondition * 100;\n    if (correctRejection12SetSizeRtC.length !== 0) {\n      sumCorrectRejection12SetSizeRtC = correctRejection12SetSizeRtC.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      correctRejection12SetSizeRtC.push(0);\n      sumCorrectRejection12SetSizeRtC = correctRejection12SetSizeRtC;\n    }\n    avgCorrectRejection12SetSizeRtC = sumCorrectRejection12SetSizeRtC / 1000 / correctRejection12SetSizeRtC.length;\n\n    // 24 setsize section\n    hitAccuracy24SetSizeC = hit24SetSizeRtC.length / trialNumberPerCondition * 100;\n    if (hit24SetSizeRtC.length !== 0) {\n      sumHit24SetSizeRtC = hit24SetSizeRtC.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      hit24SetSizeRtC.push(0);\n      sumHit24SetSizeRtC = hit24SetSizeRtC;\n    }\n    avgHit24SetSizeRtC = sumHit24SetSizeRtC / 1000 / hit24SetSizeRtC.length;\n    correctRejectionAccuracy24SetSizeC = correctRejection24SetSizeRtC.length / trialNumberPerCondition * 100;\n    if (correctRejection24SetSizeRtC.length !== 0) {\n      sumCorrectRejection24SetSizeRtC = correctRejection24SetSizeRtC.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      correctRejection24SetSizeRtC.push(0);\n      sumCorrectRejection24SetSizeRtC = correctRejection24SetSizeRtC;\n    }\n    avgCorrectRejection24SetSizeRtC = sumCorrectRejection24SetSizeRtC / 1000 / correctRejection24SetSizeRtC.length;\n\n    // 44 setsize section\n    hitAccuracy44SetSizeC = hit44SetSizeRtC.length / trialNumberPerCondition * 100;\n    if (hit44SetSizeRtC.length !== 0) {\n      sumHit44SetSizeRtC = hit44SetSizeRtC.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      hit44SetSizeRtC.push(0);\n      sumHit44SetSizeRtC = hit44SetSizeRtC;\n    }\n    avgHit44SetSizeRtC = sumHit44SetSizeRtC / 1000 / hit44SetSizeRtC.length;\n    correctRejectionAccuracy44SetSizeC = correctRejection44SetSizeRtC.length / trialNumberPerCondition * 100;\n    if (correctRejection44SetSizeRtC.length !== 0) {\n      sumCorrectRejection44SetSizeRtC = correctRejection44SetSizeRtC.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      correctRejection44SetSizeRtC.push(0);\n      sumCorrectRejection44SetSizeRtC = correctRejection44SetSizeRtC;\n    }\n    avgCorrectRejection44SetSizeRtC = sumCorrectRejection44SetSizeRtC / 1000 / correctRejection44SetSizeRtC.length;\n  }\n  function summaryScore() {\n    for (let correctIndex = latestHitRtIndex; correctIndex < comboCount.length; correctIndex++) {\n      latestHitRtIndex = correctIndex;\n      let rtScore = rtBound - hitRt[correctIndex];\n      let comboMultiplier = 0;\n      if (comboCount[correctIndex] === 0) {\n        comboMultiplier = 1;\n      } else if (comboCount[correctIndex] === 1) {\n        comboMultiplier = 1.05;\n      } else if (comboCount[correctIndex] === 2) {\n        comboMultiplier = 1.10;\n      } else if (comboCount[correctIndex] === 3) {\n        comboMultiplier = 1.20;\n      } else if (comboCount[correctIndex] === 4) {\n        comboMultiplier = 1.50;\n      } else if (comboCount[correctIndex] === 5) {\n        comboMultiplier = 2.00;\n      }\n      rtScore *= comboMultiplier;\n      scorePerTrial.push(rtScore);\n    }\n    sumScores = scorePerTrial.reduce((sum, score) => {\n      return sum + score;\n    });\n    sumRt = allRt.reduce((sum, scores) => {\n      return sum + scores;\n    });\n    if (hitRt.length !== 0) {\n      sumHitRt = hitRt.reduce((sum, score) => {\n        return sum + score;\n      });\n    } else {\n      hitRt.push(0);\n      sumHitRt = hitRt;\n    }\n    avgHitRt = sumHitRt / 1000 / hitRt.length;\n    if (avgHitRt < 1) {\n      swiftness = \"เร็วมาก\";\n    } else if (avgHitRt < 2) {\n      swiftness = \"เร็ว\";\n    } else {\n      swiftness = \"ปานกลาง\";\n    }\n    total = Math.max(10000, Math.round((sumScores - (incorrectCount * incorrectMultiplier + correctButLateCount * lateMultiplier)) * scoresMultiplier / trialNumber));\n    return total;\n  }\n  function Done() {\n    setIsItDone(true);\n    score = total;\n    hightestSetSizeCheck(checkAns, setSizeRecord);\n    scoringDataResult = scoringData(rtBound, incorrectMultiplier, lateMultiplier, scoresMultiplier, trialNumber, total);\n    metricDataResult = metricData(trialNumber, incorrectCount, correctButLateCount, setSizeInCorrectAns, timeLimitRecord, hitRt, avgHitRt, swiftness);\n    postEntryResult = postEntry(targetDataResult, trialDataResult, gameLogicSchemeResult, scoringDataResult, metricDataResult);\n    axios.post('https://exercise-vercel-svelte-backend.vercel.app/api/hard/conjunction_search', postEntryResult).then(function (postEntryResult) {\n      console.log(postEntryResult);\n    }).catch(function (error) {\n      console.log('error');\n    });\n    saveJSONDataToClientDevice(postEntryResult, `Subject${props.userId}_visualsearch_hard_session${props.userSession}_${thisTime().toString()}`);\n  }\n  function scoringData(rtBound, incorrectMultiplier, lateMultiplier, scoresMultiplier, trialNumber, total) {\n    scoringDataResult = [{\n      \"scoringModel\": {\n        \"scoringName\": \"default\",\n        \"parameters\": {\n          \"rtBound\": {\n            \"value\": rtBound,\n            \"unit\": null,\n            \"description\": \"rtBound - hitRt = rtScore\"\n          },\n          \"incorrectMultiplier\": {\n            \"value\": incorrectMultiplier,\n            \"unit\": null,\n            \"description\": \"Multiplier for incorrectCount\"\n          },\n          \"lateMultiplier\": {\n            \"value\": lateMultiplier,\n            \"unit\": null,\n            \"description\": \"Multiplier for correctButLateCount\"\n          },\n          \"scoresMultiplier\": {\n            \"value\": scoresMultiplier,\n            \"unit\": null,\n            \"description\": \"Multiplier for total score\"\n          },\n          \"trialNumber\": {\n            \"value\": trialNumber,\n            \"unit\": null,\n            \"description\": \"Total number of trials\"\n          }\n        },\n        \"description\": `score = (sumScores - (incorrectCount * incorrectMultiplier + correctButLateCount * lateMultiplier)) * scoresMultiplier / trialNumber; comboMultiplier depends on comboCount if comboCount = [0, 1, 2, 3, 4, 5] -> comboMultiplier = [1, 1.05, 1.10, 1.20, 1.50, 2]`\n      },\n      \"score\": total\n    }];\n    return scoringDataResult;\n  }\n  function hightestSetSizeCheck(checkAns, setSizeRecord) {\n    for (let i = 0; i < checkAns.length; i++) {\n      if (checkAns[i] === 'right' || checkAns[i] === 'late') {\n        setSizeInCorrectAns.push(setSizeRecord[i]);\n      }\n    }\n    setSizeInCorrectAns.sort((a, b) => a - b);\n    return setSizeInCorrectAns;\n  }\n  function metricData(trialNumber, incorrectCount, correctButLateCount, setSizeInCorrectAns, timeLimitRecord, hitRt, avgHitRt, swiftness) {\n    timeLimitRecord.sort((a, b) => a - b);\n    hitRt.sort((a, b) => a - b);\n    let metricName = ['correctCount', 'incorrectCount', 'correctButLateCount', 'highestSetSize', 'lowestTimeLimit', 'fastestHitReactionTime', 'averageHitReactionTime', 'swiftness', 'hitAccuracyFeature2SS', 'avgHitReactionTimeFeature2SS', 'hitAccuracyFeature6SS', 'avgHitReactionTimeFeature6SS', 'hitAccuracyFeature12SS', 'avgHitReactionTimeFeature12SS', 'hitAccuracyFeature24SS', 'avgHitReactionTimeFeature24SS', 'hitAccuracyFeature44SS', 'avgHitReactionTimeFeature44SS', 'correctRejectionAccuracyFeature2SS', 'avgCorrectRejectionTimeFeature2SS', 'correctRejectionAccuracyFeature6SS', 'avgCorrectRejectionTimeFeature6SS', 'correctRejectionAccuracyFeature12SS', 'avgCorrectRejectionTimeFeature12SS', 'correctRejectionAccuracyFeature24SS', 'avgCorrectRejectionTimeFeature24SS', 'correctRejectionAccuracyFeature44SS', 'avgCorrectRejectionTimeFeature44SS', 'hitAccuracyConjunction2SS', 'avgHitReactionTimeConjunction2SS', 'hitAccuracyConjunction6SS', 'avgHitReactionTimeConjunction6SS', 'hitAccuracyConjunction12SS', 'avgHitReactionTimeConjunction12SS', 'hitAccuracyConjunction24SS', 'avgHitReactionTimeConjunction24SS', 'hitAccuracyConjunction44SS', 'avgHitReactionTimeConjunction44SS', 'correctRejectionAccuracyConjunction2SS', 'avgCorrectRejectionTimeConjunction2SS', 'correctRejectionAccuracyConjunction6SS', 'avgCorrectRejectionTimeConjunction6SS', 'correctRejectionAccuracyConjunction12SS', 'avgCorrectRejectionTimeConjunction12SS', 'correctRejectionAccuracyConjunction24SS', 'avgCorrectRejectionTimeConjunction24SS', 'correctRejectionAccuracyConjunction44SS', 'avgCorrectRejectionTimeConjunction44SS'];\n    let metricValue = [trialNumber - incorrectCount, incorrectCount, correctButLateCount, setSizeInCorrectAns[setSizeInCorrectAns.length - 1], timeLimitRecord[1], hitRt[0], avgHitRt, swiftness, hitAccuracy2SetSizeF, avgHit2SetSizeRtF, hitAccuracy6SetSizeF, avgHit6SetSizeRtF, hitAccuracy12SetSizeF, avgHit12SetSizeRtF, hitAccuracy24SetSizeF, avgHit24SetSizeRtF, hitAccuracy44SetSizeF, avgHit44SetSizeRtF, correctRejectionAccuracy2SetSizeF, avgCorrectRejection2SetSizeRtF, correctRejectionAccuracy6SetSizeF, avgCorrectRejection6SetSizeRtF, correctRejectionAccuracy12SetSizeF, avgCorrectRejection12SetSizeRtF, correctRejectionAccuracy24SetSizeF, avgCorrectRejection24SetSizeRtF, correctRejectionAccuracy44SetSizeF, avgCorrectRejection44SetSizeRtF, hitAccuracy2SetSizeC, avgHit2SetSizeRtC, hitAccuracy6SetSizeC, avgHit6SetSizeRtC, hitAccuracy12SetSizeC, avgHit12SetSizeRtC, hitAccuracy24SetSizeC, avgHit24SetSizeRtC, hitAccuracy44SetSizeC, avgHit44SetSizeRtC, correctRejectionAccuracy2SetSizeC, avgCorrectRejection2SetSizeRtC, correctRejectionAccuracy6SetSizeC, avgCorrectRejection6SetSizeRtC, correctRejectionAccuracy12SetSizeC, avgCorrectRejection12SetSizeRtC, correctRejectionAccuracy24SetSizeC, avgCorrectRejection24SetSizeRtC, correctRejectionAccuracy44SetSizeC, avgCorrectRejection44SetSizeRtC];\n    let metricUnit = [null, null, null, null, 'ms', 'ms', 's', null, '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's'];\n    let metricDescription = ['Total number of correct trials', 'Total number of incorrect trials', 'Total number of correct but late trials', 'The highest set size that user reached', 'The lowest time limit for trials that user reached', 'The fastest hit reaction time that user reached', 'The average of all hit reaction time', 'The quality of all hit reaction time', 'The accuracy of 2 setsize hit in feature mode', 'The average reaction time of all 2 setsize hit in feature mode', 'The accuracy of 6 setsize hit in feature mode', 'The average reaction time of all 6 setsize hit in feature mode', 'The accuracy of 12 setsize hit in feature mode', 'The average reaction time of all 12 setsize hit in feature mode', 'The accuracy of 24 setsize hit in feature mode', 'The average reaction time of all 24 setsize hit in feature mode', 'The accuracy of 44 setsize hit in feature mode', 'The average reaction time of all 44 setsize hit in feature mode', 'The accuracy of 2 setsize correct rejection in feature mode', 'The average reaction time of all 2 setsize correct rejection in feature mode', 'The accuracy of 6 setsize correct rejection in feature mode', 'The average reaction time of all 6 setsize correct rejection in feature mode', 'The accuracy of 12 setsize correct rejection in feature mode', 'The average reaction time of all 12 setsize correct rejection in feature mode', 'The accuracy of 24 setsize correct rejection in feature mode', 'The average reaction time of all 24 setsize correct rejection in feature mode', 'The accuracy of 44 setsize correct rejection in feature mode', 'The average reaction time of all 44 setsize correct rejection in feature mode', 'The accuracy of 2 setsize hit in conjunction mode', 'The average reaction time of all 2 setsize hit in conjunction mode', 'The accuracy of 6 setsize hit in conjunction mode', 'The average reaction time of all 6 setsize hit in conjunction mode', 'The accuracy of 12 setsize hit in conjunction mode', 'The average reaction time of all 12 setsize hit in conjunction mode', 'The accuracy of 24 setsize hit in conjunction mode', 'The average reaction time of all 24 setsize hit in conjunction mode', 'The accuracy of 44 setsize hit in conjunction mode', 'The average reaction time of all 44 setsize hit in conjunction mode', 'The accuracy of 2 setsize correct rejection in conjunction mode', 'The average reaction time of all 2 setsize correct rejection in conjunction mode', 'The accuracy of 6 setsize correct rejection in conjunction mode', 'The average reaction time of all 6 setsize correct rejection in conjunction mode', 'The accuracy of 12 setsize correct rejection in conjunction mode', 'The average reaction time of all 12 setsize correct rejection in conjunction mode', 'The accuracy of 24 setsize correct rejection in conjunction mode', 'The average reaction time of all 24 setsize correct rejection in conjunction mode', 'The accuracy of 44 setsize correct rejection in conjunction mode', 'The average reaction time of all 44 setsize correct rejection in conjunction mode'];\n    for (let i = 0; i < metricName.length; i++) {\n      let obj_to_append;\n      obj_to_append = {\n        \"metricName\": metricName[i],\n        \"value\": metricValue[i],\n        \"unit\": metricUnit[i],\n        \"description\": metricDescription[i]\n      };\n      metricDataResult.push(obj_to_append);\n    }\n    return metricDataResult;\n  }\n  function postEntry(targetDataResult, trialDataResult, gameLogicSchemeResult, scoringDataResult, metricDataResult) {\n    postEntryResult = {\n      \"date\": `${thisTime().toString()}`,\n      \"userId\": props.userId,\n      \"userPhone\": props.userPhone,\n      \"userSession\": props.userSession,\n      \"data\": {\n        \"rawData\": {\n          \"target\": targetDataResult,\n          \"trialData\": trialDataResult\n        },\n        \"gameLogicScheme\": gameLogicSchemeResult,\n        \"scoringData\": scoringDataResult,\n        \"metricData\": metricDataResult\n      }\n    };\n    return postEntryResult;\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"h-screen w-full bg-slate-50 flex flex-col\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-center items-center flex-grow p-5\",\n      children: [/*#__PURE__*/_jsxDEV(CJSWindow, {\n        searchTarget: searchTarget,\n        searchTargetList: searchTargetList,\n        canvasWidth: canvasWidth,\n        canvasHeight: canvasHeight\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1465,\n        columnNumber: 18\n      }, this), /*#__PURE__*/_jsxDEV(CJSButton, {\n        searchTarget: searchTarget,\n        disabledButton: disabledButton,\n        checkResp: checkResp\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1466,\n        columnNumber: 18\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1464,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 1463,\n    columnNumber: 9\n  }, this);\n}\n_s(CJSGame, \"mitMalo+NDGvY9VzlvZtdQKk24Q=\", false, function () {\n  return [useNavigate, useSound, useSound, useSound];\n});\n_c = CJSGame;\nexport default CJSGame;\nfunction endTime() {\n  let d = new Date();\n  return d.getTime();\n}\nfunction thisTime() {\n  let thisTime = moment().format('YYYY-MM-DDTkk:mm:ss.SSSSSS');\n  return thisTime;\n}\nvar _c;\n$RefreshReg$(_c, \"CJSGame\");","map":{"version":3,"names":["useEffect","useState","useNavigate","CJSWindow","useSound","clickSoundSrc","combo2SoundSrc","losingSoundSrc","moment","Shuffle","vismem","CJSButton","saveJSONDataToClientDevice","axios","jsxDEV","_jsxDEV","myCanvas","canvasContext","trialNumber","currTrial","backgroundColor","stimulusColor","searchTargetList","description","color","shape","canvasWidth","canvasHeight","squareWidth","squareHeight","radius","positionJitter","centerX","centerY","Xspan","Yspan","XblockNumber","YblockNumber","Xblock","Yblock","X","Y","Xs","Ys","Xtemps","Ytemps","posId","maxSS","Math","floor","ceilingSS","currSS","initialSetSize","preTestSetsizeAndTarget","postTestSetsizeAndTarget","middleSetsizeAndTarget","allSetsizeAndTarget","change","NaN","shapeRand","ori","col","oris","cols","ceilingTimeLimit","timeLimit","timeLimitDeclineStep","timeLimitInclineStep","checkAns","thatRight","responseText","timeoutList","count","NupNdown","trackRecord","levelUpCount","STT","ET","sumRt","allRt","sumHitRt","hitRt","hit2SetSizeRtF","hit6SetSizeRtF","hit12SetSizeRtF","hit24SetSizeRtF","hit44SetSizeRtF","correctRejection2SetSizeRtF","correctRejection6SetSizeRtF","correctRejection12SetSizeRtF","correctRejection24SetSizeRtF","correctRejection44SetSizeRtF","hit2SetSizeRtC","hit6SetSizeRtC","hit12SetSizeRtC","hit24SetSizeRtC","hit44SetSizeRtC","correctRejection2SetSizeRtC","correctRejection6SetSizeRtC","correctRejection12SetSizeRtC","correctRejection24SetSizeRtC","correctRejection44SetSizeRtC","latestHitRtIndex","correctButLateCount","lateMultiplier","incorrectCount","incorrectMultiplier","scorePerTrial","sumScores","scoresMultiplier","comboCount","rtBound","avgHitRt","avgHit2SetSizeRtF","avgHit6SetSizeRtF","avgHit12SetSizeRtF","avgHit24SetSizeRtF","avgHit44SetSizeRtF","avgCorrectRejection2SetSizeRtF","avgCorrectRejection6SetSizeRtF","avgCorrectRejection12SetSizeRtF","avgCorrectRejection24SetSizeRtF","avgCorrectRejection44SetSizeRtF","hitAccuracy2SetSizeF","hitAccuracy6SetSizeF","hitAccuracy12SetSizeF","hitAccuracy24SetSizeF","hitAccuracy44SetSizeF","correctRejectionAccuracy2SetSizeF","correctRejectionAccuracy6SetSizeF","correctRejectionAccuracy12SetSizeF","correctRejectionAccuracy24SetSizeF","correctRejectionAccuracy44SetSizeF","avgHit2SetSizeRtC","avgHit6SetSizeRtC","avgHit12SetSizeRtC","avgHit24SetSizeRtC","avgHit44SetSizeRtC","avgCorrectRejection2SetSizeRtC","avgCorrectRejection6SetSizeRtC","avgCorrectRejection12SetSizeRtC","avgCorrectRejection24SetSizeRtC","avgCorrectRejection44SetSizeRtC","hitAccuracy2SetSizeC","hitAccuracy6SetSizeC","hitAccuracy12SetSizeC","hitAccuracy24SetSizeC","hitAccuracy44SetSizeC","correctRejectionAccuracy2SetSizeC","correctRejectionAccuracy6SetSizeC","correctRejectionAccuracy12SetSizeC","correctRejectionAccuracy24SetSizeC","correctRejectionAccuracy44SetSizeC","swiftness","total","score","targetMatch","allStartTime","allClickTime","allCurrSS","gameLogicSchemeResult","trialDataResult","stimulusDataResult","targetDataResult","scoringDataResult","timeLimitRecord","setSizeRecord","setSizeInCorrectAns","metricDataResult","allSearchMode","postEntryResult","CJSGame","props","_s","navigate","clickSound","combo2Sound","losingSound","searchTarget","setSearchTarget","progressValue","setProgressValue","disabledButton","setDisabledButton","isItDone","setIsItDone","colorSet","setColorSet","userId","initiateData","checkStimuliColorSet","createPseudorandomStimuli","gameLogicScheme","forEach","tm","clearTimeout","switchSearchMode","window","location","href","includes","allSetsizeRange","trialsPerSetsize","targetCondition","trialsPerCondition","searchMode","miniBlocks","trialsPerBlock","probabilities","iSetsize","length","iRep","iTarget","push","reverse","slice","probability","targetAppear","round","targetAbsent","featureArray","Array","fill","concat","conjunctionArray","middleIndex","splice","console","log","j","k","createCanvas","initialT","document","getElementById","getContext","width","height","ix","iy","hidden","_waittime","SS","erase","clear","shuffleSS","targetData","makeBackground","makeSearchArray","stimulusData","realX","realY","drawObjects","objects","dT","Date","getTime","thisTime","setSize","makeRectangle","numarrayX","numarrayY","orienVec","colorVec","i","makeCircle","random","find","x","id","thisShape","thisParameterName","thisValue","obj_in_trial","obj_to_append","y","type","trialData","thisAns","checkResp","foo","dT2","rt","trialIsOver","summarySetSize","summaryScore","Done","trialConclude","textHeight","font","textWidth","measureText","setTimeout","text","makeText","drawText","sumHit2SetSizeRtF","sumHit6SetSizeRtF","sumHit12SetSizeRtF","sumHit24SetSizeRtF","sumHit44SetSizeRtF","sumCorrectRejection2SetSizeRtF","sumCorrectRejection6SetSizeRtF","sumCorrectRejection12SetSizeRtF","sumCorrectRejection24SetSizeRtF","sumCorrectRejection44SetSizeRtF","sumHit2SetSizeRtC","sumHit6SetSizeRtC","sumHit12SetSizeRtC","sumHit24SetSizeRtC","sumHit44SetSizeRtC","sumCorrectRejection2SetSizeRtC","sumCorrectRejection6SetSizeRtC","sumCorrectRejection12SetSizeRtC","sumCorrectRejection24SetSizeRtC","sumCorrectRejection44SetSizeRtC","featureOrConjunctionCondition","appearOrDisappearCondition","setSizeCondition","trialNumberPerCondition","reduce","sum","correctIndex","rtScore","comboMultiplier","scores","max","hightestSetSizeCheck","scoringData","metricData","postEntry","post","then","catch","error","userSession","toString","sort","a","b","metricName","metricValue","metricUnit","metricDescription","userPhone","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","endTime","d","format","$RefreshReg$"],"sources":["/Users/pavlov/Documents/GitHub/vss-visual-search/src/pages/game/cjsGame/CJSGame.tsx"],"sourcesContent":["import { useContext, useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport './CJSGame.css';\nimport BreadCrumb from '../../../components/breadcrumbs/breadCrumb';\nimport CJSWindow from '../../../components/gameWindow/cjsWindow/CJSWindow';\nimport ScoreSummaryOverlay from '../../../components/scoreSummaryOverlay/ScoreSummaryOverlay';\nimport useSound from 'use-sound';\nimport clickSoundSrc from '../../../assets/sound/click.mp3';\nimport combo2SoundSrc from '../../../assets/sound/combo2.mp3';\nimport losingSoundSrc from '../../../assets/sound/losingStreak.mp3';\nimport moment from 'moment';\nimport { Shuffle } from '../../../scripts/shuffle';\nimport * as vismem from '../../../scripts/vismemCC_simon';\nimport CJSButton from '../../../components/gameWindow/cjsWindow/cjsButton/CJSButton';\nimport { saveJSONDataToClientDevice } from '../../../uitls/offline';\nimport axios from 'axios';\n\nlet myCanvas: HTMLCanvasElement;\nlet canvasContext: CanvasRenderingContext2D;\nlet trialNumber;\nlet currTrial = 0;\nlet backgroundColor = '#E5E5E5';\nlet stimulusColor = ['#9370DB', '#3CB4C6', '#B2D33D', '#F67E4B']; \nlet searchTargetList: any[][] = [\n    [\n        {description: 'สี่เหลี่ยมสีม่วง', color: '#9370DB', shape: 'square'},\n        {description: 'สี่เหลี่ยมสีฟ้า', color: '#3CB4C6', shape: 'square'},\n        {description: 'สี่เหลี่ยมสีเขียว', color: '#B2D33D', shape: 'square'},\n        {description: 'สี่เหลี่ยมสีส้ม', color: '#F67E4B', shape: 'square'},\n    ],\n    [\n        {description: 'วงกลมสีม่วง', color: '#9370DB', shape: 'circle'},\n        {description: 'วงกลมสีฟ้า', color: '#3CB4C6', shape: 'circle'},\n        {description: 'วงกลมสีเขียว', color: '#B2D33D', shape: 'circle'},\n        {description: 'วงกลมสีส้ม', color: '#F67E4B', shape: 'circle'}\n    ],\n    \n]\nlet canvasWidth = 600;\nlet canvasHeight = 600;\nlet squareWidth = 45;\nlet squareHeight = 45;\nlet radius = squareWidth / 2;\nlet positionJitter = 8;\nlet centerX: number;\nlet centerY: number;\nlet Xspan = canvasWidth / 2;\nlet Yspan = canvasHeight / 2;\nlet XblockNumber = 8;\nlet YblockNumber = 6;\nlet Xblock = Xspan * 2 / XblockNumber;\nlet Yblock = Yspan * 2 / YblockNumber;\nlet X: number[]\nlet Y: number[]\nlet Xs: number[] = [];\nlet Ys: number[] = [];\nlet Xtemps: number[] = [];\nlet Ytemps: number[] = [];\nlet posId: number[] = [];\nlet maxSS = Math.floor((XblockNumber * YblockNumber - 1) / 2);\nlet ceilingSS = 0;\nlet currSS = 2;\nlet initialSetSize = 2; // must have same value as currSS\nlet preTestSetsizeAndTarget: number[][] = [];\nlet postTestSetsizeAndTarget: number[][] = [];\nlet middleSetsizeAndTarget: number[][] = [];\nlet allSetsizeAndTarget: number[][] = [];\nlet change = NaN;\nlet shapeRand: number[] = [];\nlet ori: number[]\nlet col: string[]\nlet oris: number[] = [];\nlet cols: number[] = [];\nlet ceilingTimeLimit = 10 * 1000;\nlet timeLimit = 10 * 1000;\nlet timeLimitDeclineStep = 1000;\nlet timeLimitInclineStep = 500;\nlet checkAns: string[] = [];\nlet thatRight: string = '';\nlet responseText: string = '';\nlet timeoutList: any[] = []; \nlet count = 0;\nlet NupNdown = 5;\nlet trackRecord = 0;\nlet levelUpCount = 0;\nlet STT;\nlet ET;\nlet sumRt = 0;\nlet allRt: number[] = [];\nlet sumHitRt;\nlet hitRt: number[] = [];\nlet hit2SetSizeRtF: number[] = [];\nlet hit6SetSizeRtF: number[] = [];\nlet hit12SetSizeRtF: number[] = [];\nlet hit24SetSizeRtF: number[] = [];\nlet hit44SetSizeRtF: number[] = [];\nlet correctRejection2SetSizeRtF: number[] = [];\nlet correctRejection6SetSizeRtF: number[] = [];\nlet correctRejection12SetSizeRtF: number[] = [];\nlet correctRejection24SetSizeRtF: number[] = [];\nlet correctRejection44SetSizeRtF: number[] = [];\nlet hit2SetSizeRtC: number[] = [];\nlet hit6SetSizeRtC: number[] = [];\nlet hit12SetSizeRtC: number[] = [];\nlet hit24SetSizeRtC: number[] = [];\nlet hit44SetSizeRtC: number[] = [];\nlet correctRejection2SetSizeRtC: number[] = [];\nlet correctRejection6SetSizeRtC: number[] = [];\nlet correctRejection12SetSizeRtC: number[] = [];\nlet correctRejection24SetSizeRtC: number[] = [];\nlet correctRejection44SetSizeRtC: number[] = [];\nlet latestHitRtIndex = 0;\nlet correctButLateCount = 0;\nlet lateMultiplier = 10000;\nlet incorrectCount = 0;\nlet incorrectMultiplier = 20000;\nlet scorePerTrial = [0];\nlet sumScores = 0;\nlet scoresMultiplier = 10;\nlet comboCount: number[] = [];\nlet rtBound = 10000;\nlet avgHitRt;\nlet avgHit2SetSizeRtF;\nlet avgHit6SetSizeRtF;\nlet avgHit12SetSizeRtF;\nlet avgHit24SetSizeRtF;\nlet avgHit44SetSizeRtF;\nlet avgCorrectRejection2SetSizeRtF;\nlet avgCorrectRejection6SetSizeRtF;\nlet avgCorrectRejection12SetSizeRtF;\nlet avgCorrectRejection24SetSizeRtF;\nlet avgCorrectRejection44SetSizeRtF;\nlet hitAccuracy2SetSizeF;\nlet hitAccuracy6SetSizeF;\nlet hitAccuracy12SetSizeF;\nlet hitAccuracy24SetSizeF;\nlet hitAccuracy44SetSizeF;\nlet correctRejectionAccuracy2SetSizeF;\nlet correctRejectionAccuracy6SetSizeF;\nlet correctRejectionAccuracy12SetSizeF;\nlet correctRejectionAccuracy24SetSizeF;\nlet correctRejectionAccuracy44SetSizeF;\nlet avgHit2SetSizeRtC;\nlet avgHit6SetSizeRtC;\nlet avgHit12SetSizeRtC;\nlet avgHit24SetSizeRtC;\nlet avgHit44SetSizeRtC;\nlet avgCorrectRejection2SetSizeRtC;\nlet avgCorrectRejection6SetSizeRtC;\nlet avgCorrectRejection12SetSizeRtC;\nlet avgCorrectRejection24SetSizeRtC;\nlet avgCorrectRejection44SetSizeRtC;\nlet hitAccuracy2SetSizeC;\nlet hitAccuracy6SetSizeC;\nlet hitAccuracy12SetSizeC;\nlet hitAccuracy24SetSizeC;\nlet hitAccuracy44SetSizeC;\nlet correctRejectionAccuracy2SetSizeC;\nlet correctRejectionAccuracy6SetSizeC;\nlet correctRejectionAccuracy12SetSizeC;\nlet correctRejectionAccuracy24SetSizeC;\nlet correctRejectionAccuracy44SetSizeC;\nlet swiftness: string = '';\nlet total: number = 0;\nlet score: number;\nlet targetMatch: boolean[] = [];\nlet allStartTime: string[] = [];\nlet allClickTime: string[] = [];\nlet allCurrSS: number[] = [];\nlet gameLogicSchemeResult;\nlet trialDataResult: any[] = [];\nlet stimulusDataResult: any[] = [];\nlet targetDataResult;\nlet scoringDataResult: any[] = [];\nlet timeLimitRecord: any[] = [];\nlet setSizeRecord: any[] = [];\nlet setSizeInCorrectAns: any[] = [];\nlet metricDataResult: any[] = [];\nlet allSearchMode: string[] = [];\nlet postEntryResult;\n\nfunction CJSGame(props): any {\n    const navigate = useNavigate();\n    const [clickSound] = useSound(clickSoundSrc);\n    const [combo2Sound] = useSound(combo2SoundSrc);\n    const [losingSound] = useSound(losingSoundSrc);\n    const [searchTarget, setSearchTarget] = useState<{ shape: number, col: number }>();\n    const [progressValue, setProgressValue] = useState(0);\n    const [disabledButton, setDisabledButton] = useState(false);\n    const [isItDone, setIsItDone] = useState(false);\n    const [colorSet, setColorSet] = useState(props.userId % 4);\n\n        useEffect(() => {\n            initiateData();\n            // have to set search target before switchSearchMode() & createTargetCanvas() \n            checkStimuliColorSet();\n            createPseudorandomStimuli();\n            gameLogicSchemeResult = gameLogicScheme(trialNumber, backgroundColor, squareWidth, radius, stimulusColor, positionJitter, XblockNumber, YblockNumber, ceilingTimeLimit, timeLimitDeclineStep, timeLimitInclineStep, canvasHeight, canvasWidth, initialSetSize);\n            return() => {\n                timeoutList.forEach(tm => {\n                    clearTimeout(tm);\n                })\n            };\n        }, [])\n\n        useEffect(() => {\n            switchSearchMode();\n        }, [searchTarget])\n\n    function gameLogicScheme(trialNumber, backgroundColor, squareWidth, radius, stimulusColor, positionJitter, XblockNumber, YblockNumber, ceilingTimeLimit, timeLimitDeclineStep, timeLimitInclineStep, canvasHeight, canvasWidth, initialSetSize){\n        gameLogicSchemeResult = {\n            \"game\" : \"face-in-the-crowd \",\n            \"schemeName\" : \"default\",\n            \"version\" : \"1.0\",\n            \"variant\" : \"main\",\n            \"parameters\" : {\n                \"trialNumber\": {\n                    \"value\" : trialNumber,\n                    \"unit\" : null,\n                    \"description\" : \"Total number of trials\"\n                },\n                \"backgroundColor\": {\n                    \"value\": backgroundColor,\n                    \"unit\": null,\n                    \"description\" : \"Background color of test canvas\"\n                },\n                \"stimulusShape\" : {\n                    \"value\" : [\n                        {\n                            \"shapeName\": \"square\",\n                            \"parameters\": {\n                                \"squareWidth\" : {\n                                    \"value\": squareWidth,\n                                    \"unit\": \"px\",\n                                    \"description\" : \"Square stimulus width\"\n                                }\n                            },\n                            \"description\" : \"Square stimulus\"\n                        }, \n                        {\n                            \"shapeName\": \"circle\",\n                            \"parameters\": {\n                                \"radius\" : {\n                                    \"value\": radius,\n                                    \"unit\": \"px\",\n                                    \"description\" : \"Circle stimulus radius\"\n                                }\n                            },\n                            \"description\" : \"Circle stimulus\"\n                        }\n                    ],\n                    \"unit\" : null,\n                    \"description\" : \"Set of possible stimulus shape\"\n                },\n                \"stimulusColor\": {\n                    \"value\" : stimulusColor,\n                    \"unit\" : null,\n                    \"description\" : \"Set of possible stimulus color\"\n                },\n                \"positionJitter\" : {\n                    \"value\": positionJitter,\n                    \"unit\": \"px\",\n                    \"description\": \"Amplitude of spatial jittering in each axis\"\n                },\n                \"XblockNumber\": {\n                    \"value\": XblockNumber,\n                    \"unit\": null,\n                    \"description\": \"Number of horizontal blocks composing the canvas\"\n                },\n                \"YblockNumber\": {\n                    \"value\": YblockNumber,\n                    \"unit\": null,\n                    \"description\": \"Number of vertical blocks composing the canvas\"\n                },\n                \"canvasProperty\" : {\n                    \"canvasHeight\" : {\n                        \"value\" : canvasHeight,\n                        \"unit\" : \"px\",\n                        \"description\" : \"Height of canvas\"\n                    },\n                    \"canvasWidth\" : {\n                        \"value\" : canvasWidth,\n                        \"unit\" : \"px\",\n                        \"description\" : \"Width of canvas\"\n                    }\n                },\n                \"initialSetSize\" : {\n                    \"value\": initialSetSize,\n                    \"unit\": null,\n                    \"description\" : \"Initial set size\"\n                }\n            },\n            \"description\" : \"Conjunction search default scheme\"\n        }\n        return gameLogicSchemeResult;\n    }\n\n    function initiateData() {\n        hitRt = [];\n        allRt = [];\n        currSS = 2;\n        ceilingSS = 0;\n        latestHitRtIndex = 0;\n        comboCount = [];\n        correctButLateCount = 0;\n        incorrectCount = 0;\n        count = 0;\n        currTrial = 0;\n        Xtemps = [];\n        Xs = [];\n        Ytemps = [];\n        Ys = [];\n        posId = [];\n    }\n\n    function checkStimuliColorSet(){\n        if (props.userId % 2 === 0){ // ถ้า userId เป็นเลขคู่\n            if (window.location.href.includes('face-in-the-crowd-A')){\n                setSearchTarget({ shape: 0, col: colorSet });\n            } else {\n                setSearchTarget({ shape: 1, col: (colorSet + 1) % 4 });\n            }\n            \n        } else { // ถ้า userId เป็นเลขคี่\n            if (window.location.href.includes('face-in-the-crowd-A')){\n                setSearchTarget({ shape: 1, col: colorSet });\n            } else {\n                setSearchTarget({ shape: 0, col: (colorSet + 1) % 4  });\n            }\n        }\n    }\n\n    function createPseudorandomStimuli() {\n        preTestSetsizeAndTarget = [];\n        postTestSetsizeAndTarget = [];\n        middleSetsizeAndTarget = [];\n        allSetsizeAndTarget = [];\n        let allSetsizeRange = [31];\n        let trialsPerSetsize = 60; \n        let targetCondition = 2; // target appear or disappear\n        let trialsPerCondition = trialsPerSetsize / targetCondition; \n        let searchMode = 2; // feature or conjunction \n        let miniBlocks = 6; // in middle blocks \n        let trialsPerBlock = trialsPerSetsize / miniBlocks; // จำนวน trials ต่อ mini-block\n        let probabilities = [1.0, 0.8, 0.6, 0.4, 0.2, 0.0]; // โอกาสการปรากฏของ 1 ในแต่ละ mini-block\n\n        // conjunction search pre-test and post-test\n        for (let iSetsize = 0; iSetsize < allSetsizeRange.length; iSetsize++) {\n            for (let iRep = 0; iRep < trialsPerCondition; iRep++) {\n                for (let iTarget = 0; iTarget < targetCondition; iTarget++) {\n                    preTestSetsizeAndTarget.push([allSetsizeRange[iSetsize], iTarget, 1]);\n                    postTestSetsizeAndTarget.push([allSetsizeRange[iSetsize], iTarget, 1]);\n                }\n            }\n        }\n        Shuffle(preTestSetsizeAndTarget); \n        Shuffle(postTestSetsizeAndTarget); \n\n        // รวม preTestSetsizeAndTarget กับ postTestSetsizeAndTarget เข้าด้วยกัน\n        allSetsizeAndTarget = [...preTestSetsizeAndTarget, ...postTestSetsizeAndTarget];\n\n        if (window.location.href.includes('face-in-the-crowd-A')){\n            probabilities = [1.0, 0.8, 0.6, 0.4, 0.2, 0.0];\n        } else {\n            probabilities.reverse();\n        }\n\n        // feature search + conjunction search 6 mini-blocks \n        // ก่อนจะแทรก middleSetsizeAndTarget เช็คให้ชัวร์ก่อนว่า allSetsizeAndTarget มีครบทั้ง pre และ post-test\n        if (allSetsizeAndTarget.length === preTestSetsizeAndTarget.length + postTestSetsizeAndTarget.length) {\n            probabilities.slice(0, miniBlocks).forEach(probability => {\n                const targetAppear: number = Math.round(trialsPerBlock * probability); // จำนวนครั้งที่ต้อง push 1\n                const targetAbsent: number = trialsPerBlock - targetAppear; // ที่เหลือเป็น 0\n    \n                // สร้าง array ที่มี 1 และ 0 ตามจำนวนที่คำนวณ ของ feature search\n                const featureArray: number[] = Array(targetAppear).fill(1).concat(Array(targetAbsent).fill(0));\n    \n                // สร้าง array ที่มี 1 และ 0 ตามจำนวนที่คำนวณ ของ conjunction search (0 และ 1 อย่างละครึ่ง)\n                const conjunctionArray: number[] = Array(trialsPerBlock / 2).fill(0).concat(Array(trialsPerBlock / 2).fill(1));\n    \n                // สุ่มให้คละกัน\n                Shuffle(featureArray)\n                Shuffle(conjunctionArray)\n    \n                for (let iSetsize = 0; iSetsize < allSetsizeRange.length; iSetsize++) {\n                    for (let iTarget = 0; iTarget < featureArray.length; iTarget++) {\n                        middleSetsizeAndTarget.push([allSetsizeRange[iSetsize], featureArray[iTarget], 0])\n                    }\n    \n                    for (let iTarget = 0; iTarget < conjunctionArray.length; iTarget++) {\n                        middleSetsizeAndTarget.push([allSetsizeRange[iSetsize], conjunctionArray[iTarget], 1])\n                    }\n    \n                }\n            });\n            \n            // หา index ตรงกลางของ allSetsizeAndTarget เพื่อแทรก middleSetsizeAndTarget เข้าไป\n            const middleIndex = Math.floor(allSetsizeAndTarget.length / 2); // ตำแหน่งกลางของ array\n            allSetsizeAndTarget.splice(middleIndex, 0, ...middleSetsizeAndTarget)\n        }\n\n        // กำหนดค่า trialNumber ให้เท่ากับจำนวนข้อทั้งหมด\n        trialNumber = allSetsizeAndTarget.length;\n        console.log(trialNumber)\n    }\n\n    function switchSearchMode() {\n        if (searchTarget) {\n            oris = [];\n            cols = [];\n            if (allSetsizeAndTarget[currTrial][2] === 0) {\n                // feature search\n                allSearchMode.push('feature search');\n                for (let j = 0; j < maxSS; j++) { oris.push(0); oris.push(0)};\n                if (searchTarget.shape === 1) {\n                    shapeRand = [1];\n                } else {\n                    shapeRand = [0];\n                }\n                if (searchTarget.col === 0) {\n                    for (let k = 0; k < maxSS; k++) { cols.push(2); cols.push(2)};\n                } else if (searchTarget.col === 1) {\n                    for (let k = 0; k < maxSS; k++) { cols.push(3); cols.push(3)};\n                } else if (searchTarget.col === 2) {\n                    for (let k = 0; k < maxSS; k++) { cols.push(0); cols.push(0)};\n                } else if (searchTarget.col === 3) {\n                    for (let k = 0; k < maxSS; k++) { cols.push(1); cols.push(1)};\n                }\n            } else {\n                // conjunction search\n                allSearchMode.push('conjunction search');\n                for (let j = 0; j < maxSS; j++) { oris.push(0); oris.push(1)};\n                if (searchTarget.col === 0) {\n                    for (let k = 0; k < maxSS; k++) { cols.push(0); cols.push(2)};\n                } else if (searchTarget.col === 1) {\n                    for (let k = 0; k < maxSS; k++) { cols.push(1); cols.push(3)};\n                } else if (searchTarget.col === 2) {\n                    for (let k = 0; k < maxSS; k++) { cols.push(2); cols.push(0)};\n                } else if (searchTarget.col === 3) {\n                    for (let k = 0; k < maxSS; k++) { cols.push(3); cols.push(1)};\n                }\n                if (searchTarget.shape === 1) {\n                    shapeRand = [1];\n                } \n                else {\n                    shapeRand = [0];\n                }\n            }\n\n            // if createCanvas() runs before switchSearchMode() the target and distractors position might be overlapped\n            if (currTrial === 0){ \n                // create only one time when the game started\n                createCanvas();\n            }\n            initialT(0, allSetsizeAndTarget[currTrial][0]);\n        }\n    }\n    \n    function createCanvas() {\n        myCanvas = document.getElementById(\"myCanvas\") as HTMLCanvasElement;\n        canvasContext = myCanvas.getContext(\"2d\") as CanvasRenderingContext2D;\n        centerX = myCanvas.width / 2;\n        centerY = myCanvas.height / 2;\n\n        for (var ix = 0; ix < XblockNumber; ix++) {\n            Xtemps.push(Math.round(Xblock / 2) + Xblock * ix - Xspan + centerX);\n        }\n\n        for (var iy = 0; iy < YblockNumber; iy++) {\n            Ytemps.push(Math.round(Yblock / 2) + Yblock * iy - Yspan + centerY);\n        }\n\n        for (ix = 0; ix < XblockNumber; ix++) {\n            for (iy = 0; iy < YblockNumber; iy++) {\n                Xs.push(Xtemps[ix]);\n                Ys.push(Ytemps[iy]);\n                posId.push(count);\n                count++;\n            }\n        }\n        myCanvas.hidden = false;\n    }\n\n    function initialT(_waittime, SS) {\n        setDisabledButton(false);\n        setSizeRecord.push(SS);\n        timeLimitRecord.push(timeLimit);\n        if (!ceilingSS) {\n            ceilingSS = SS + 1;\n        };\n        vismem.erase(canvasContext);\n        vismem.clear();\n        allCurrSS.push(allSetsizeAndTarget[currTrial][0]);\n        shuffleSS(SS);\n        targetData(squareWidth, ori, col);\n        makeBackground(backgroundColor);\n        makeSearchArray(X, Y, squareWidth, squareHeight, ori, col);\n        stimulusData(realX, realY, squareWidth, ori, col);\n        vismem.drawObjects(canvasContext, vismem.objects);\n        let dT = new Date();\n        STT = dT.getTime();\n        allStartTime.push(thisTime());\n    }\n\n    function shuffleSS(setSize) {\n        Shuffle(posId);\n        X = []; for (let ix = 0; ix < setSize + 1; ix++) { X.push(Xs[posId[ix]]) };\n        Y = []; for (let iy = 0; iy < setSize + 1; iy++) { Y.push(Ys[posId[iy]]) };\n        ori = []; for (let j = 0; j < setSize; j++) { ori.push(oris[j]) };\n        col = []; for (let j = 0; j < setSize; j++) { col.push(stimulusColor[cols[j]]) };\n\n        // check if this trial is feature or conjunction search\n        if (allSetsizeAndTarget[currTrial][2] === 0) {\n            // feature search\n            // check if the target appears or disappears\n            if (allSetsizeAndTarget[currTrial][1] === 0) {\n                // disappears\n                ori.push(oris[setSize]);\n                col.push(stimulusColor[cols[setSize]]);\n            } else {\n                // appears\n                if (oris[setSize] === 0) {\n                    ori.push(1);\n                } else {\n                    ori.push(1);\n                }\n\n                if (cols[setSize] === 0) {\n                    col.push(stimulusColor[2]);\n                } else if (cols[setSize] === 1) {\n                    col.push(stimulusColor[3]);\n                } else if (cols[setSize] === 2) {\n                    col.push(stimulusColor[0]);\n                } else if (cols[setSize] === 3) {\n                    col.push(stimulusColor[1]);\n                }\n            }\n        } else {\n            // conjunction search\n            // check if the target appears or disappears\n            if (allSetsizeAndTarget[currTrial][1] === 0) {\n                // disappears\n                ori.push(oris[setSize]);\n                col.push(stimulusColor[cols[setSize]]);\n            } else {\n                // appears\n                if (oris[setSize] === 0) {\n                    ori.push(1);\n                } else {\n                    ori.push(1);\n                }\n\n                if (cols[setSize] === 0) {\n                    col.push(stimulusColor[2]);\n                } else if (cols[setSize] === 1) {\n                    col.push(stimulusColor[3]);\n                } else if (cols[setSize] === 2) {\n                    col.push(stimulusColor[0]);\n                } else if (cols[setSize] === 3) {\n                    col.push(stimulusColor[1]);\n                }\n            }\n        }\n    }\n\n    function makeBackground(backgroundColor) {\n        // Fill background\n        vismem.makeRectangle('bg', centerX, centerY, canvasWidth, canvasHeight, false, backgroundColor, backgroundColor);\n    }\n\n    let realX: number[] = [];\n    let realY: number[] = [];\n    function makeSearchArray(numarrayX, numarrayY, squareWidth, squareHeight, orienVec, colorVec) {\n        for (let i = 0; i < orienVec.length; i++) {\n            if (orienVec[i] === shapeRand[0]) {\n                vismem.makeCircle('c', numarrayX[i] + (Math.random() - 0.5) * 2 * positionJitter, numarrayY[i] + (Math.random() - 0.5) * 2 * positionJitter, radius, false, colorVec[i], colorVec[i]);\n            } else {\n                vismem.makeRectangle('s', numarrayX[i] + (Math.random() - 0.5) * 2 * positionJitter, numarrayY[i] + (Math.random() - 0.5) * 2 * positionJitter, squareHeight, squareWidth, false, colorVec[i], colorVec[i], 0, 0);\n            }\n            realX.push(numarrayX[i] + (Math.random() - 0.5) * 2 * positionJitter);\n            realY.push(numarrayY[i] + (Math.random() - 0.5) * 2 * positionJitter);\n        }\n        if (searchTarget) {\n            // Find Target from Object\n            let find = vismem.objects.find(x => x.id === (searchTarget.shape === 0 ? 's' : 'c') && x.color === stimulusColor[searchTarget.col])\n            change = find ? 1 : 0\n            targetMatch.push(find ? true : false);\n        }\n    }\n    \n    function targetData(width, ori, col) {\n        let thisShape = \"\";\n        let thisParameterName = \"\";\n        let thisValue = 0;\n        let obj_in_trial: any[] = [];\n        let obj_to_append;\n        if (shapeRand[0] === 1) {\n            thisShape = \"circle\";\n                thisParameterName = \"radius\";\n                thisValue = radius;\n            } else {\n                thisShape = \"square\";\n                thisParameterName = \"width\";\n                thisValue = width;\n            }\n\n            if (searchTarget) {\n                obj_to_append = {\n                    \"shape\" : thisShape,\n                    \"shapeParams\" : {\n                        \"parameterName\" : thisParameterName,\n                        \"value\" : thisValue,\n                        \"unit\" : \"px\"\n                    },\n                    \"color\" : stimulusColor[searchTarget.col]\n                }\n                obj_in_trial.push(obj_to_append);\n            }\n        targetDataResult = obj_in_trial[obj_in_trial.length - 1];\n        return targetDataResult;\n    }\n\n    function stimulusData(x, y, width, ori, col) {\n        let thisShape = \"\";\n        let thisParameterName = \"\";\n        let thisValue = 0;\n        let obj_in_trial: any[] = [];\n        \n        for (let i = 0; i < col.length; i++){\n            let obj_to_append;\n            if (ori[i] === shapeRand[0]) {\n                thisShape = \"circle\";\n                thisParameterName = \"radius\";\n                thisValue = radius;\n            } else {\n                thisShape = \"square\";\n                thisParameterName = \"width\";\n                thisValue = width;\n            }\n                obj_to_append = {\n                \"type\" : \"distractor\",\n                \"display\" : {\n                    \"shape\" : thisShape,\n                    \"shapeParams\" : {\n                        \"parameterName\" : thisParameterName,\n                        \"value\" : thisValue,\n                        \"unit\" : \"px\"\n                    },\n                    \"color\" : col[i]\n                },\n                \"position\" : {\n                    \"x\" : {\n                        \"value\" : x[i],\n                        \"unit\" : \"px\"\n                    },\n                    \"y\" : {\n                        \"value\" : y[i],\n                        \"unit\" : \"px\"\n                    }\n                }\n            }   \n            obj_in_trial.push(obj_to_append);\n        }\n        obj_in_trial[obj_in_trial.length - 1].type = \"target\";\n        stimulusDataResult.push(obj_in_trial);\n        return stimulusDataResult;\n    }\n\n    function trialData(targetMatch, allStartTime, allCurrSS, allClickTime, checkAns, stimulusDataResult, allSearchMode){\n        let thisAns;\n        let obj_in_trial: any[] = [];\n        for (let i = 0; i < targetMatch.length; i++){\n            let obj_to_append;\n            if (checkAns[i] === 'right' || checkAns[i] === 'late'){\n                thisAns = true;\n            } else {\n                thisAns = false;\n            }\n            obj_to_append = {\n                \"hasTarget\" : targetMatch[i],\n                \"startTime\" : allStartTime[i],\n                \"setSize\" : allCurrSS[i],\n                \"answerTime\" : allClickTime[i],\n                \"hasTargetAnswerBool\" : thisAns,\n                \"stimulusData\" : stimulusDataResult[i],\n                \"mode\" : allSearchMode[i]\n            }\n            obj_in_trial.push(obj_to_append);\n        }\n        trialDataResult.push(obj_in_trial[obj_in_trial.length - 1]);\n        return trialDataResult;\n    }\n    \n    function checkResp(foo) {\n        setProgressValue(progressValue + 1);\n        clickSound();\n        let dT2 = new Date();\n        ET = dT2.getTime();\n        allClickTime.push(thisTime());\n        let rt = ET - STT;\n        allRt.push(rt);\n        if (change === foo) {\n            combo2Sound();\n            if (rt < timeLimit) {\n                trackRecord = trackRecord + 1;\n                thatRight = 'right';\n                checkAns.push(thatRight);\n                hitRt.push(rt);\n                if (levelUpCount === 0) {\n                    comboCount.push(0);\n                } else if (levelUpCount === 1) {\n                    comboCount.push(1);\n                } else if (levelUpCount === 2) {\n                    comboCount.push(2);\n                } else if (levelUpCount === 3) {\n                    comboCount.push(3);\n                } else if (levelUpCount === 4) {\n                    comboCount.push(4);\n                } else if (levelUpCount === 5) {\n                    comboCount.push(5);\n                }\n            } else {\n                combo2Sound();\n                thatRight = 'late';\n                trackRecord = 0;\n                checkAns.push(thatRight);\n                correctButLateCount++;\n            }\n\n            // check if feature or conjunction mode\n            if (allSetsizeAndTarget[currTrial][2] === 0){\n                // feature\n                // check if target appear or disappear\n                if (allSetsizeAndTarget[currTrial][1] === 0){\n                    // disappear\n                    // check setsize that correct rejection\n                    if (allSetsizeAndTarget[currTrial][0] === 2){\n                        correctRejection2SetSizeRtF.push(rt);\n                    } else if (allSetsizeAndTarget[currTrial][0] === 6) {\n                        correctRejection6SetSizeRtF.push(rt);\n                    } else if (allSetsizeAndTarget[currTrial][0] === 12) {\n                        correctRejection12SetSizeRtF.push(rt);\n                    } else if (allSetsizeAndTarget[currTrial][0] === 24) {\n                        correctRejection24SetSizeRtF.push(rt);\n                    } else if (allSetsizeAndTarget[currTrial][0] === 44) {\n                        correctRejection44SetSizeRtF.push(rt);\n                    }\n                } else {\n                    // appear\n                    // check setsize that hit\n                    if (allSetsizeAndTarget[currTrial][0] === 2){\n                        hit2SetSizeRtF.push(rt);\n                    } else if (allSetsizeAndTarget[currTrial][0] === 6) {\n                        hit6SetSizeRtF.push(rt);\n                    } else if (allSetsizeAndTarget[currTrial][0] === 12) {\n                        hit12SetSizeRtF.push(rt);\n                    } else if (allSetsizeAndTarget[currTrial][0] === 24) {\n                        hit24SetSizeRtF.push(rt);\n                    } else if (allSetsizeAndTarget[currTrial][0] === 44) {\n                        hit44SetSizeRtF.push(rt);\n                    }\n                }\n            } else {\n                // conjunction\n                // check if target appear or disappear\n                if (allSetsizeAndTarget[currTrial][1] === 0){\n                    // disappear\n                    // check setsize that correct rejection\n                    if (allSetsizeAndTarget[currTrial][0] === 2){\n                        correctRejection2SetSizeRtC.push(rt);\n                    } else if (allSetsizeAndTarget[currTrial][0] === 6) {\n                        correctRejection6SetSizeRtC.push(rt);\n                    } else if (allSetsizeAndTarget[currTrial][0] === 12) {\n                        correctRejection12SetSizeRtC.push(rt);\n                    } else if (allSetsizeAndTarget[currTrial][0] === 24) {\n                        correctRejection24SetSizeRtC.push(rt);\n                    } else if (allSetsizeAndTarget[currTrial][0] === 44) {\n                        correctRejection44SetSizeRtC.push(rt);\n                    }\n                } else {\n                    // appear\n                    // check setsize that hit\n                    if (allSetsizeAndTarget[currTrial][0] === 2){\n                        hit2SetSizeRtC.push(rt);\n                    } else if (allSetsizeAndTarget[currTrial][0] === 6) {\n                        hit6SetSizeRtC.push(rt);\n                    } else if (allSetsizeAndTarget[currTrial][0] === 12) {\n                        hit12SetSizeRtC.push(rt);\n                    } else if (allSetsizeAndTarget[currTrial][0] === 24) {\n                        hit24SetSizeRtC.push(rt);\n                    } else if (allSetsizeAndTarget[currTrial][0] === 44) {\n                        hit44SetSizeRtC.push(rt);\n                    }\n                }\n            }\n        } else {\n            losingSound();\n            thatRight = 'wrong';\n            trackRecord = 0;\n            checkAns.push(thatRight);\n            incorrectCount++;\n        }\n        trialDataResult = trialData(targetMatch, allStartTime, allCurrSS, allClickTime, checkAns, stimulusDataResult, allSearchMode);\n        trialIsOver();\n    }\n\n    function trialIsOver() {\n        vismem.erase(canvasContext);\n        vismem.clear();\n        makeBackground(backgroundColor)\n        vismem.drawObjects(canvasContext, vismem.objects);\n        if (trackRecord >= NupNdown) {\n            if (allSetsizeAndTarget[currTrial][0] < maxSS * 2 - 2) {\n                // currSS = currSS + 2;\n                ceilingSS = allSetsizeAndTarget[currTrial][0] + 1;\n                if (levelUpCount === 5) {\n                    levelUpCount = 5;\n                } else {\n                    levelUpCount++\n                }\n            } else {\n                ceilingSS = allSetsizeAndTarget[currTrial][0] + 1;\n                timeLimit = timeLimit - timeLimitDeclineStep;\n            }\n        }\n\n        if (trackRecord === 0 && allSetsizeAndTarget[currTrial][0] > 4) {\n            // currSS = currSS - 2;\n            timeLimit = timeLimit + timeLimitInclineStep;\n            if (timeLimit > ceilingTimeLimit) {\n                timeLimit = ceilingTimeLimit;\n            }\n        }\n        currTrial = currTrial + 1;\n        if (currTrial >= trialNumber) {\n            summarySetSize();\n            summaryScore();\n            Done();\n        } else {\n            trialConclude();\n        }\n    }\n    \n    function trialConclude() {\n        setDisabledButton(true);\n        vismem.erase(canvasContext);\n        vismem.clear();\n        makeBackground(backgroundColor);\n        vismem.drawObjects(canvasContext, vismem.objects);\n        \n        let textHeight = 0;\n        if (thatRight === 'wrong'){\n            responseText = \"ผิด\";\n            textHeight = 36;\n        } else {\n            responseText = \"ถูก\";\n            textHeight = 20;\n        }\n\n        canvasContext.font = \"120px Sarabun\"\n        let textWidth = canvasContext.measureText(responseText).width;\n        timeoutList.push(\n            setTimeout(function() {\n                let text = vismem.makeText('t', centerX - textWidth/2, centerY + textHeight, responseText, \"Black\", canvasContext.font);\n                vismem.drawText(canvasContext, text);\n            }, 100),\n\n            setTimeout(function() {\n                vismem.erase(canvasContext);\n                vismem.clear();\n                makeBackground(backgroundColor);\n                vismem.drawObjects(canvasContext, vismem.objects);\n            }, 600),\n\n            setTimeout(function() {\n                switchSearchMode();\n            }, 900)\n        )\n    }\n\n    function summarySetSize() {\n        let sumHit2SetSizeRtF;\n        let sumHit6SetSizeRtF;\n        let sumHit12SetSizeRtF;\n        let sumHit24SetSizeRtF;\n        let sumHit44SetSizeRtF;\n        let sumCorrectRejection2SetSizeRtF;\n        let sumCorrectRejection6SetSizeRtF;\n        let sumCorrectRejection12SetSizeRtF;\n        let sumCorrectRejection24SetSizeRtF;\n        let sumCorrectRejection44SetSizeRtF;\n        let sumHit2SetSizeRtC;\n        let sumHit6SetSizeRtC;\n        let sumHit12SetSizeRtC;\n        let sumHit24SetSizeRtC;\n        let sumHit44SetSizeRtC;\n        let sumCorrectRejection2SetSizeRtC;\n        let sumCorrectRejection6SetSizeRtC;\n        let sumCorrectRejection12SetSizeRtC;\n        let sumCorrectRejection24SetSizeRtC;\n        let sumCorrectRejection44SetSizeRtC;\n        let featureOrConjunctionCondition = 2; // feature or conjunction\n        let appearOrDisappearCondition = 2; // appear or disappear\n        let setSizeCondition = 5; // [2, 6, 12, 24, 44] setsize\n        let trialNumberPerCondition = allSetsizeAndTarget.length / (featureOrConjunctionCondition * appearOrDisappearCondition * setSizeCondition);\n\n        // feature section\n        // 2 setsize section\n        hitAccuracy2SetSizeF = hit2SetSizeRtF.length / trialNumberPerCondition * 100;\n        if (hit2SetSizeRtF.length !== 0){\n            sumHit2SetSizeRtF = hit2SetSizeRtF.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            hit2SetSizeRtF.push(0);\n            sumHit2SetSizeRtF = hit2SetSizeRtF;\n        }\n\n        avgHit2SetSizeRtF = sumHit2SetSizeRtF / 1000 / hit2SetSizeRtF.length;\n\n        correctRejectionAccuracy2SetSizeF = correctRejection2SetSizeRtF.length / trialNumberPerCondition * 100;\n        if (correctRejection2SetSizeRtF.length !== 0){\n            sumCorrectRejection2SetSizeRtF = correctRejection2SetSizeRtF.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            correctRejection2SetSizeRtF.push(0);\n            sumCorrectRejection2SetSizeRtF = correctRejection2SetSizeRtF;\n        }\n\n        avgCorrectRejection2SetSizeRtF = sumCorrectRejection2SetSizeRtF / 1000 / correctRejection2SetSizeRtF.length;\n\n        // 6 setsize section\n        hitAccuracy6SetSizeF = hit6SetSizeRtF.length / trialNumberPerCondition * 100;\n        if (hit6SetSizeRtF.length !== 0){\n            sumHit6SetSizeRtF = hit6SetSizeRtF.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            hit6SetSizeRtF.push(0);\n            sumHit6SetSizeRtF = hit6SetSizeRtF;\n        }\n\n        avgHit6SetSizeRtF = sumHit6SetSizeRtF / 1000 / hit6SetSizeRtF.length;\n\n        correctRejectionAccuracy6SetSizeF = correctRejection6SetSizeRtF.length / trialNumberPerCondition * 100;\n        if (correctRejection6SetSizeRtF.length !== 0){\n            sumCorrectRejection6SetSizeRtF = correctRejection6SetSizeRtF.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            correctRejection6SetSizeRtF.push(0);\n            sumCorrectRejection6SetSizeRtF = correctRejection6SetSizeRtF;\n        }\n\n        avgCorrectRejection6SetSizeRtF = sumCorrectRejection6SetSizeRtF / 1000 / correctRejection6SetSizeRtF.length;\n\n        // 12 setsize section\n        hitAccuracy12SetSizeF = hit12SetSizeRtF.length / trialNumberPerCondition * 100;\n        if (hit12SetSizeRtF.length !== 0){\n            sumHit12SetSizeRtF = hit12SetSizeRtF.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            hit12SetSizeRtF.push(0);\n            sumHit12SetSizeRtF = hit2SetSizeRtF;\n        }\n\n        avgHit12SetSizeRtF = sumHit12SetSizeRtF / 1000 / hit12SetSizeRtF.length;\n\n        correctRejectionAccuracy12SetSizeF = correctRejection12SetSizeRtF.length / trialNumberPerCondition * 100;\n        if (correctRejection12SetSizeRtF.length !== 0){\n            sumCorrectRejection12SetSizeRtF = correctRejection12SetSizeRtF.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            correctRejection12SetSizeRtF.push(0);\n            sumCorrectRejection12SetSizeRtF = correctRejection12SetSizeRtF;\n        }\n\n        avgCorrectRejection12SetSizeRtF = sumCorrectRejection12SetSizeRtF / 1000 / correctRejection12SetSizeRtF.length;\n\n        // 24 setsize section\n        hitAccuracy24SetSizeF = hit24SetSizeRtF.length / trialNumberPerCondition * 100;\n        if (hit24SetSizeRtF.length !== 0){\n            sumHit24SetSizeRtF = hit24SetSizeRtF.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            hit24SetSizeRtF.push(0);\n            sumHit24SetSizeRtF = hit24SetSizeRtF;\n        }\n\n        avgHit24SetSizeRtF = sumHit24SetSizeRtF / 1000 / hit24SetSizeRtF.length;\n\n        correctRejectionAccuracy24SetSizeF = correctRejection24SetSizeRtF.length / trialNumberPerCondition * 100;\n        if (correctRejection24SetSizeRtF.length !== 0){\n            sumCorrectRejection24SetSizeRtF = correctRejection24SetSizeRtF.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            correctRejection24SetSizeRtF.push(0);\n            sumCorrectRejection24SetSizeRtF = correctRejection24SetSizeRtF;\n        }\n\n        avgCorrectRejection24SetSizeRtF = sumCorrectRejection24SetSizeRtF / 1000 / correctRejection24SetSizeRtF.length;\n\n        // 44 setsize section\n        hitAccuracy44SetSizeF = hit44SetSizeRtF.length / trialNumberPerCondition * 100;\n        if (hit44SetSizeRtF.length !== 0){\n            sumHit44SetSizeRtF = hit44SetSizeRtF.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            hit44SetSizeRtF.push(0);\n            sumHit44SetSizeRtF = hit44SetSizeRtF;\n        }\n\n        avgHit44SetSizeRtF = sumHit44SetSizeRtF / 1000 / hit44SetSizeRtF.length;\n\n        correctRejectionAccuracy44SetSizeF = correctRejection44SetSizeRtF.length / trialNumberPerCondition * 100;\n        if (correctRejection44SetSizeRtF.length !== 0){\n            sumCorrectRejection44SetSizeRtF = correctRejection44SetSizeRtF.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            correctRejection44SetSizeRtF.push(0);\n            sumCorrectRejection44SetSizeRtF = correctRejection44SetSizeRtF;\n        }\n\n        avgCorrectRejection44SetSizeRtF = sumCorrectRejection44SetSizeRtF / 1000 / correctRejection44SetSizeRtF.length;\n\n        // conjunction section\n        // 2 setsize section\n        hitAccuracy2SetSizeC = hit2SetSizeRtC.length / trialNumberPerCondition * 100;\n        if (hit2SetSizeRtC.length !== 0){\n            sumHit2SetSizeRtC = hit2SetSizeRtC.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            hit2SetSizeRtC.push(0);\n            sumHit2SetSizeRtC = hit2SetSizeRtC;\n        }\n\n        avgHit2SetSizeRtC = sumHit2SetSizeRtC / 1000 / hit2SetSizeRtC.length;\n\n        correctRejectionAccuracy2SetSizeC = correctRejection2SetSizeRtC.length / trialNumberPerCondition * 100;\n        if (correctRejection2SetSizeRtC.length !== 0){\n            sumCorrectRejection2SetSizeRtC = correctRejection2SetSizeRtC.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            correctRejection2SetSizeRtC.push(0);\n            sumCorrectRejection2SetSizeRtC = correctRejection2SetSizeRtC;\n        }\n\n        avgCorrectRejection2SetSizeRtC = sumCorrectRejection2SetSizeRtC / 1000 / correctRejection2SetSizeRtC.length;\n\n        // 6 setsize section\n        hitAccuracy6SetSizeC = hit6SetSizeRtC.length / trialNumberPerCondition * 100;\n        if (hit6SetSizeRtC.length !== 0){\n            sumHit6SetSizeRtC = hit6SetSizeRtC.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            hit6SetSizeRtC.push(0);\n            sumHit6SetSizeRtC = hit6SetSizeRtC;\n        }\n\n        avgHit6SetSizeRtC = sumHit6SetSizeRtC / 1000 / hit6SetSizeRtC.length;\n\n        correctRejectionAccuracy6SetSizeC = correctRejection6SetSizeRtC.length / trialNumberPerCondition * 100;\n        if (correctRejection6SetSizeRtC.length !== 0){\n            sumCorrectRejection6SetSizeRtC = correctRejection6SetSizeRtC.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            correctRejection6SetSizeRtC.push(0);\n            sumCorrectRejection6SetSizeRtC = correctRejection6SetSizeRtC;\n        }\n\n        avgCorrectRejection6SetSizeRtC = sumCorrectRejection6SetSizeRtC / 1000 / correctRejection6SetSizeRtC.length;\n\n        // 12 setsize section\n        hitAccuracy12SetSizeC = hit12SetSizeRtC.length / trialNumberPerCondition * 100;\n        if (hit12SetSizeRtC.length !== 0){\n            sumHit12SetSizeRtC = hit12SetSizeRtC.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            hit12SetSizeRtC.push(0);\n            sumHit12SetSizeRtC = hit2SetSizeRtC;\n        }\n\n        avgHit12SetSizeRtC = sumHit12SetSizeRtC / 1000 / hit12SetSizeRtC.length;\n\n        correctRejectionAccuracy12SetSizeC = correctRejection12SetSizeRtC.length / trialNumberPerCondition * 100;\n        if (correctRejection12SetSizeRtC.length !== 0){\n            sumCorrectRejection12SetSizeRtC = correctRejection12SetSizeRtC.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            correctRejection12SetSizeRtC.push(0);\n            sumCorrectRejection12SetSizeRtC = correctRejection12SetSizeRtC;\n        }\n\n        avgCorrectRejection12SetSizeRtC = sumCorrectRejection12SetSizeRtC / 1000 / correctRejection12SetSizeRtC.length;\n\n        // 24 setsize section\n        hitAccuracy24SetSizeC = hit24SetSizeRtC.length / trialNumberPerCondition * 100;\n        if (hit24SetSizeRtC.length !== 0){\n            sumHit24SetSizeRtC = hit24SetSizeRtC.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            hit24SetSizeRtC.push(0);\n            sumHit24SetSizeRtC = hit24SetSizeRtC;\n        }\n\n        avgHit24SetSizeRtC = sumHit24SetSizeRtC / 1000 / hit24SetSizeRtC.length;\n\n        correctRejectionAccuracy24SetSizeC = correctRejection24SetSizeRtC.length / trialNumberPerCondition * 100;\n        if (correctRejection24SetSizeRtC.length !== 0){\n            sumCorrectRejection24SetSizeRtC = correctRejection24SetSizeRtC.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            correctRejection24SetSizeRtC.push(0);\n            sumCorrectRejection24SetSizeRtC = correctRejection24SetSizeRtC;\n        }\n\n        avgCorrectRejection24SetSizeRtC = sumCorrectRejection24SetSizeRtC / 1000 / correctRejection24SetSizeRtC.length;\n\n        // 44 setsize section\n        hitAccuracy44SetSizeC = hit44SetSizeRtC.length / trialNumberPerCondition * 100;\n        if (hit44SetSizeRtC.length !== 0){\n            sumHit44SetSizeRtC = hit44SetSizeRtC.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            hit44SetSizeRtC.push(0);\n            sumHit44SetSizeRtC = hit44SetSizeRtC;\n        }\n\n        avgHit44SetSizeRtC = sumHit44SetSizeRtC / 1000 / hit44SetSizeRtC.length;\n\n        correctRejectionAccuracy44SetSizeC = correctRejection44SetSizeRtC.length / trialNumberPerCondition * 100;\n        if (correctRejection44SetSizeRtC.length !== 0){\n            sumCorrectRejection44SetSizeRtC = correctRejection44SetSizeRtC.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            correctRejection44SetSizeRtC.push(0);\n            sumCorrectRejection44SetSizeRtC = correctRejection44SetSizeRtC;\n        }\n\n        avgCorrectRejection44SetSizeRtC = sumCorrectRejection44SetSizeRtC / 1000 / correctRejection44SetSizeRtC.length;\n    }\n\n    function summaryScore() {\n        for (let correctIndex = latestHitRtIndex; correctIndex < comboCount.length; correctIndex++) {\n            latestHitRtIndex = correctIndex;\n            let rtScore = rtBound - hitRt[correctIndex];\n            let comboMultiplier = 0;\n            if (comboCount[correctIndex] === 0) {\n                comboMultiplier = 1;\n            } else if (comboCount[correctIndex] === 1) {\n                comboMultiplier = 1.05;\n            } else if (comboCount[correctIndex] === 2) {\n                comboMultiplier = 1.10;\n            } else if (comboCount[correctIndex] === 3) {\n                comboMultiplier = 1.20;\n            } else if (comboCount[correctIndex] === 4) {\n                comboMultiplier = 1.50;\n            } else if (comboCount[correctIndex] === 5) {\n                comboMultiplier = 2.00;\n            }\n            rtScore *= comboMultiplier;\n            scorePerTrial.push(rtScore);\n        }\n        sumScores = scorePerTrial.reduce((sum, score) => {\n            return sum + score;\n        });\n\n        sumRt = allRt.reduce((sum, scores) => {\n            return sum + scores;\n        });\n\n        if (hitRt.length !== 0){\n            sumHitRt = hitRt.reduce((sum, score) => {\n                return sum + score;\n            });\n        } else {\n            hitRt.push(0);\n            sumHitRt = hitRt;\n        }\n\n        avgHitRt = sumHitRt / 1000 / hitRt.length;\n        if (avgHitRt < 1) {\n            swiftness = \"เร็วมาก\";\n        }\n        else if (avgHitRt < 2) {\n            swiftness = \"เร็ว\";\n        }\n        else {\n            swiftness = \"ปานกลาง\";\n        }\n\n        total = Math.max(10000, Math.round((sumScores - (incorrectCount * incorrectMultiplier + correctButLateCount * lateMultiplier)) * scoresMultiplier / trialNumber));\n\n        return total;\n    }\n\n    function Done() {\n        setIsItDone(true);\n        score = total;\n        hightestSetSizeCheck(checkAns, setSizeRecord);\n        scoringDataResult = scoringData(rtBound, incorrectMultiplier, lateMultiplier, scoresMultiplier, trialNumber, total);\n        metricDataResult = metricData(trialNumber, incorrectCount, correctButLateCount, setSizeInCorrectAns, timeLimitRecord, hitRt, avgHitRt, swiftness);\n        postEntryResult = postEntry(targetDataResult, trialDataResult, gameLogicSchemeResult, scoringDataResult, metricDataResult);\n        axios.post('https://exercise-vercel-svelte-backend.vercel.app/api/hard/conjunction_search', postEntryResult)\n            .then(function (postEntryResult) {\n                console.log(postEntryResult)\n            })\n            .catch(function (error) {\n                console.log('error')\n            });\n        saveJSONDataToClientDevice(postEntryResult, `Subject${props.userId}_visualsearch_hard_session${props.userSession}_${thisTime().toString()}`);\n    }\n\n    function scoringData(rtBound, incorrectMultiplier, lateMultiplier, scoresMultiplier, trialNumber, total){\n        scoringDataResult = [{\n            \"scoringModel\" : {\n                \"scoringName\" : \"default\",\n                \"parameters\" : {\n                    \"rtBound\" : {\n                        \"value\" : rtBound,\n                        \"unit\" : null,\n                        \"description\" : \"rtBound - hitRt = rtScore\"\n                    },\n                    \"incorrectMultiplier\" : {\n                        \"value\" : incorrectMultiplier,\n                        \"unit\" : null,\n                        \"description\" : \"Multiplier for incorrectCount\"\n                    },\n                    \"lateMultiplier\" : {\n                        \"value\" : lateMultiplier,\n                        \"unit\" : null,\n                        \"description\" : \"Multiplier for correctButLateCount\"\n                    },\n                    \"scoresMultiplier\" : {\n                        \"value\" : scoresMultiplier,\n                        \"unit\" : null,\n                        \"description\" : \"Multiplier for total score\"\n                    },\n                    \"trialNumber\" : {\n                        \"value\" : trialNumber,\n                        \"unit\" : null,\n                        \"description\" : \"Total number of trials\"\n                    }\n                },\n                \"description\" : `score = (sumScores - (incorrectCount * incorrectMultiplier + correctButLateCount * lateMultiplier)) * scoresMultiplier / trialNumber; comboMultiplier depends on comboCount if comboCount = [0, 1, 2, 3, 4, 5] -> comboMultiplier = [1, 1.05, 1.10, 1.20, 1.50, 2]`\n            },\n            \"score\" : total\n        }]\n        return scoringDataResult;\n    }\n\n    function hightestSetSizeCheck(checkAns, setSizeRecord){\n        for (let i = 0; i < checkAns.length; i++){\n            if (checkAns[i] === 'right' || checkAns[i] === 'late'){\n                setSizeInCorrectAns.push(setSizeRecord[i])\n            } \n        }\n        setSizeInCorrectAns.sort((a,b) => a-b);\n        return setSizeInCorrectAns;\n    }\n\n    function metricData(trialNumber, incorrectCount, correctButLateCount, setSizeInCorrectAns, timeLimitRecord, hitRt, avgHitRt, swiftness){\n        timeLimitRecord.sort((a,b) => a-b);\n        hitRt.sort((a,b) => a-b);\n        let metricName \n            = ['correctCount', \n               'incorrectCount', \n               'correctButLateCount', \n               'highestSetSize', \n               'lowestTimeLimit', \n               'fastestHitReactionTime', \n               'averageHitReactionTime', \n               'swiftness',\n               'hitAccuracyFeature2SS',\n               'avgHitReactionTimeFeature2SS',\n               'hitAccuracyFeature6SS',\n               'avgHitReactionTimeFeature6SS',\n               'hitAccuracyFeature12SS',\n               'avgHitReactionTimeFeature12SS',\n               'hitAccuracyFeature24SS',\n               'avgHitReactionTimeFeature24SS',\n               'hitAccuracyFeature44SS',\n               'avgHitReactionTimeFeature44SS',\n               'correctRejectionAccuracyFeature2SS',\n               'avgCorrectRejectionTimeFeature2SS',\n               'correctRejectionAccuracyFeature6SS',\n               'avgCorrectRejectionTimeFeature6SS',\n               'correctRejectionAccuracyFeature12SS',\n               'avgCorrectRejectionTimeFeature12SS',\n               'correctRejectionAccuracyFeature24SS',\n               'avgCorrectRejectionTimeFeature24SS',\n               'correctRejectionAccuracyFeature44SS',\n               'avgCorrectRejectionTimeFeature44SS',\n               'hitAccuracyConjunction2SS',\n               'avgHitReactionTimeConjunction2SS',\n               'hitAccuracyConjunction6SS',\n               'avgHitReactionTimeConjunction6SS',\n               'hitAccuracyConjunction12SS',\n               'avgHitReactionTimeConjunction12SS',\n               'hitAccuracyConjunction24SS',\n               'avgHitReactionTimeConjunction24SS',\n               'hitAccuracyConjunction44SS',\n               'avgHitReactionTimeConjunction44SS',\n               'correctRejectionAccuracyConjunction2SS',\n               'avgCorrectRejectionTimeConjunction2SS',\n               'correctRejectionAccuracyConjunction6SS',\n               'avgCorrectRejectionTimeConjunction6SS',\n               'correctRejectionAccuracyConjunction12SS',\n               'avgCorrectRejectionTimeConjunction12SS',\n               'correctRejectionAccuracyConjunction24SS',\n               'avgCorrectRejectionTimeConjunction24SS',\n               'correctRejectionAccuracyConjunction44SS',\n               'avgCorrectRejectionTimeConjunction44SS',];\n        let metricValue \n            = [trialNumber - incorrectCount, \n               incorrectCount, \n               correctButLateCount, \n               setSizeInCorrectAns[setSizeInCorrectAns.length - 1], \n               timeLimitRecord[1], \n               hitRt[0], \n               avgHitRt, \n               swiftness,\n               hitAccuracy2SetSizeF,\n               avgHit2SetSizeRtF,\n               hitAccuracy6SetSizeF,\n               avgHit6SetSizeRtF,\n               hitAccuracy12SetSizeF,\n               avgHit12SetSizeRtF,\n               hitAccuracy24SetSizeF,\n               avgHit24SetSizeRtF,\n               hitAccuracy44SetSizeF,\n               avgHit44SetSizeRtF,\n               correctRejectionAccuracy2SetSizeF,\n               avgCorrectRejection2SetSizeRtF,\n               correctRejectionAccuracy6SetSizeF,\n               avgCorrectRejection6SetSizeRtF,\n               correctRejectionAccuracy12SetSizeF,\n               avgCorrectRejection12SetSizeRtF,\n               correctRejectionAccuracy24SetSizeF,\n               avgCorrectRejection24SetSizeRtF,\n               correctRejectionAccuracy44SetSizeF,\n               avgCorrectRejection44SetSizeRtF,\n               hitAccuracy2SetSizeC,\n               avgHit2SetSizeRtC,\n               hitAccuracy6SetSizeC,\n               avgHit6SetSizeRtC,\n               hitAccuracy12SetSizeC,\n               avgHit12SetSizeRtC,\n               hitAccuracy24SetSizeC,\n               avgHit24SetSizeRtC,\n               hitAccuracy44SetSizeC,\n               avgHit44SetSizeRtC,\n               correctRejectionAccuracy2SetSizeC,\n               avgCorrectRejection2SetSizeRtC,\n               correctRejectionAccuracy6SetSizeC,\n               avgCorrectRejection6SetSizeRtC,\n               correctRejectionAccuracy12SetSizeC,\n               avgCorrectRejection12SetSizeRtC,\n               correctRejectionAccuracy24SetSizeC,\n               avgCorrectRejection24SetSizeRtC,\n               correctRejectionAccuracy44SetSizeC,\n               avgCorrectRejection44SetSizeRtC,];\n        let metricUnit = [null, null, null, null, 'ms', 'ms', 's', null, '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's', '%', 's'];\n        let metricDescription \n            = ['Total number of correct trials', \n               'Total number of incorrect trials', \n               'Total number of correct but late trials', \n               'The highest set size that user reached', \n               'The lowest time limit for trials that user reached', \n               'The fastest hit reaction time that user reached', \n               'The average of all hit reaction time', \n               'The quality of all hit reaction time',\n               'The accuracy of 2 setsize hit in feature mode',\n               'The average reaction time of all 2 setsize hit in feature mode',\n               'The accuracy of 6 setsize hit in feature mode',\n               'The average reaction time of all 6 setsize hit in feature mode',\n               'The accuracy of 12 setsize hit in feature mode',\n               'The average reaction time of all 12 setsize hit in feature mode',\n               'The accuracy of 24 setsize hit in feature mode',\n               'The average reaction time of all 24 setsize hit in feature mode',\n               'The accuracy of 44 setsize hit in feature mode',\n               'The average reaction time of all 44 setsize hit in feature mode',\n               'The accuracy of 2 setsize correct rejection in feature mode',\n               'The average reaction time of all 2 setsize correct rejection in feature mode',\n               'The accuracy of 6 setsize correct rejection in feature mode',\n               'The average reaction time of all 6 setsize correct rejection in feature mode',\n               'The accuracy of 12 setsize correct rejection in feature mode',\n               'The average reaction time of all 12 setsize correct rejection in feature mode',\n               'The accuracy of 24 setsize correct rejection in feature mode',\n               'The average reaction time of all 24 setsize correct rejection in feature mode',\n               'The accuracy of 44 setsize correct rejection in feature mode',\n               'The average reaction time of all 44 setsize correct rejection in feature mode',\n               'The accuracy of 2 setsize hit in conjunction mode',\n               'The average reaction time of all 2 setsize hit in conjunction mode',\n               'The accuracy of 6 setsize hit in conjunction mode',\n               'The average reaction time of all 6 setsize hit in conjunction mode',\n               'The accuracy of 12 setsize hit in conjunction mode',\n               'The average reaction time of all 12 setsize hit in conjunction mode',\n               'The accuracy of 24 setsize hit in conjunction mode',\n               'The average reaction time of all 24 setsize hit in conjunction mode',\n               'The accuracy of 44 setsize hit in conjunction mode',\n               'The average reaction time of all 44 setsize hit in conjunction mode',\n               'The accuracy of 2 setsize correct rejection in conjunction mode',\n               'The average reaction time of all 2 setsize correct rejection in conjunction mode',\n               'The accuracy of 6 setsize correct rejection in conjunction mode',\n               'The average reaction time of all 6 setsize correct rejection in conjunction mode',\n               'The accuracy of 12 setsize correct rejection in conjunction mode',\n               'The average reaction time of all 12 setsize correct rejection in conjunction mode',\n               'The accuracy of 24 setsize correct rejection in conjunction mode',\n               'The average reaction time of all 24 setsize correct rejection in conjunction mode',\n               'The accuracy of 44 setsize correct rejection in conjunction mode',\n               'The average reaction time of all 44 setsize correct rejection in conjunction mode',];\n        for (let i = 0; i < metricName.length; i++){\n            let obj_to_append\n            obj_to_append = {\n                \"metricName\" : metricName[i],\n                \"value\" : metricValue[i],\n                \"unit\" : metricUnit[i],\n                \"description\" : metricDescription[i]\n            }\n            metricDataResult.push(obj_to_append);\n        }    \n        return metricDataResult;\n    }\n\n    function postEntry(targetDataResult, trialDataResult, gameLogicSchemeResult, scoringDataResult, metricDataResult){\n        postEntryResult = {\n            \"date\" : `${thisTime().toString()}`,\n            \"userId\" : props.userId,\n            \"userPhone\" : props.userPhone,\n            \"userSession\" : props.userSession,\n            \"data\" : {\n                \"rawData\" : {\n                    \"target\" : targetDataResult,\n                    \"trialData\" : trialDataResult\n                },\n                \"gameLogicScheme\" : gameLogicSchemeResult,\n                \"scoringData\" : scoringDataResult,\n                \"metricData\" : metricDataResult\n            }\n        }\n        return postEntryResult;\n    }\n\n    return (\n        <div className='h-screen w-full bg-slate-50 flex flex-col'>\n            <div className='flex justify-center items-center flex-grow p-5'>\n                {<CJSWindow searchTarget={searchTarget} searchTargetList={searchTargetList} canvasWidth={canvasWidth} canvasHeight={canvasHeight} />}\n                {<CJSButton searchTarget={searchTarget} disabledButton={disabledButton} checkResp={checkResp}/>}\n            </div>\n        </div>\n    )\n}\n\n\nexport default CJSGame;\n\nfunction endTime() { \n    let d = new Date();\n    return d.getTime();\n}\n\nfunction thisTime() {\n    let thisTime = moment().format('YYYY-MM-DDTkk:mm:ss.SSSSSS');\n    return thisTime;\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}