{"ast":null,"code":"import _toConsumableArray from\"/Users/pavlov/Documents/GitHub/vss-visual-search/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";// This file is module for offline service such as save file, read file, etc with local storage or indexedDB.\n// Author : Waragon P.\n// ฟังก์ชันบันทึกข้อมูลใน Local Storage\nfunction saveDataToLocalStorage(key,value){// แปลงข้อมูลเป็น string ก่อนบันทึก\nlocalStorage.setItem(key,JSON.stringify(value));}// ฟังก์ชันดึงข้อมูลจาก Local Storage\nfunction getDataFromLocalStorage(key){var value=localStorage.getItem(key);if(value){try{// แปลงข้อมูลกลับจาก string เป็นค่าเดิม\nreturn JSON.parse(value);}catch(e){console.error(\"Error parsing data from localStorage\",e);return null;}}return null;// ถ้าไม่มีข้อมูลหรือเป็น null\n}function saveDataToIndexedDB(data,DBname){// Create request to open a indexed database\nvar IDBrequest=window.indexedDB.open(DBname);// If error\nIDBrequest.onerror=function(event){console.log(\"IndexedDB error: \"+event.target.errorCode);};// If upgrade needed\nIDBrequest.onupgradeneeded=function(event){var db=IDBrequest.result;if(!db.objectStoreNames.contains(\"data\")){db.createObjectStore(\"data\");}};// If success\nIDBrequest.onsuccess=function(event){var db=IDBrequest.result;var transaction=db.transaction([\"data\"],\"readwrite\");var objectStore=transaction.objectStore(\"data\");var request=objectStore.add(data,new Date().getTime());request.onsuccess=function(event){console.log(\"Data has been added to your database.\");};transaction.oncomplete=function(event){db.close();};};}function getDataFromIndexedDB(DBname,DBversion,DBstore){// Create request to open a indexed database\nvar IDBrequest=window.indexedDB.open(DBname,DBversion);// If error\nIDBrequest.onerror=function(event){console.log(\"IndexedDB error: \"+event.target.errorCode);};// If success\nIDBrequest.onsuccess=function(event){var db=IDBrequest.result;var transaction=db.transaction([DBstore],\"readwrite\");var objectStore=transaction.objectStore(DBstore);var request=objectStore.getAll();request.onsuccess=function(event){console.log(\"Data has been added to your database.\");};transaction.oncomplete=function(event){db.close();};};}function saveDataToClientDevice(data,filename){var blob=new Blob([data],{type:'text/plain'});var url=URL.createObjectURL(blob);var a=document.createElement('a');a.setAttribute('download',filename);a.setAttribute('href',url);a.click();}function saveJSONDataToClientDevice(data,filename){saveDataToClientDevice(JSON.stringify(data),filename);}function convertJSONToCSV(data){if(!Array.isArray(data)||data.length===0){return'';}// ดึงหัวข้อจาก key ของ object ตัวแรก\nvar headers=Object.keys(data[0]);// สร้างแถวของหัวข้อและข้อมูล\nvar rows=data.map(function(row){return headers.map(function(header){var _row$header;return\"\\\"\".concat(((_row$header=row[header])!==null&&_row$header!==void 0?_row$header:'').toString().replace(/\"/g,'\"\"'),\"\\\"\");}).join(',');});// รวม headers และ rows เป็น CSV\nreturn[headers.join(',')].concat(_toConsumableArray(rows)).join('\\n');}function saveCSVDataToClientDevice(data,filename){// ตรวจสอบและเพิ่มนามสกุล .csv หากไม่มี\nif(!filename.endsWith('.csv')){filename+='.csv';}// แปลง JSON เป็น CSV\nvar csvContent=convertJSONToCSV(data);// สร้าง Blob และดาวน์โหลดไฟล์\nvar blob=new Blob([csvContent],{type:'text/csv'});var url=URL.createObjectURL(blob);var a=document.createElement('a');a.setAttribute('download',filename);a.setAttribute('href',url);a.click();}export{saveCSVDataToClientDevice,convertJSONToCSV,saveDataToLocalStorage,saveDataToIndexedDB,saveDataToClientDevice,saveJSONDataToClientDevice,getDataFromLocalStorage,getDataFromIndexedDB};","map":{"version":3,"names":["saveDataToLocalStorage","key","value","localStorage","setItem","JSON","stringify","getDataFromLocalStorage","getItem","parse","e","console","error","saveDataToIndexedDB","data","DBname","IDBrequest","window","indexedDB","open","onerror","event","log","target","errorCode","onupgradeneeded","db","result","objectStoreNames","contains","createObjectStore","onsuccess","transaction","objectStore","request","add","Date","getTime","oncomplete","close","getDataFromIndexedDB","DBversion","DBstore","getAll","saveDataToClientDevice","filename","blob","Blob","type","url","URL","createObjectURL","a","document","createElement","setAttribute","click","saveJSONDataToClientDevice","convertJSONToCSV","Array","isArray","length","headers","Object","keys","rows","map","row","header","_row$header","concat","toString","replace","join","_toConsumableArray","saveCSVDataToClientDevice","endsWith","csvContent"],"sources":["/Users/pavlov/Documents/GitHub/vss-visual-search/src/uitls/offline.ts"],"sourcesContent":["// This file is module for offline service such as save file, read file, etc with local storage or indexedDB.\n// Author : Waragon P.\n\n// ฟังก์ชันบันทึกข้อมูลใน Local Storage\nfunction saveDataToLocalStorage(key: string, value: any) {\n    // แปลงข้อมูลเป็น string ก่อนบันทึก\n    localStorage.setItem(key, JSON.stringify(value));\n}\n\n// ฟังก์ชันดึงข้อมูลจาก Local Storage\nfunction getDataFromLocalStorage(key: string) {\n    const value = localStorage.getItem(key);\n    if (value) {\n        try {\n            // แปลงข้อมูลกลับจาก string เป็นค่าเดิม\n            return JSON.parse(value);\n        } catch (e) {\n            console.error(\"Error parsing data from localStorage\", e);\n            return null;\n        }\n    }\n    return null; // ถ้าไม่มีข้อมูลหรือเป็น null\n}\n\nfunction saveDataToIndexedDB(data:any, DBname:string) {\n    // Create request to open a indexed database\n    const IDBrequest: IDBOpenDBRequest = window.indexedDB.open(DBname);\n  \n    // If error\n    IDBrequest.onerror = function(event) {\n        console.log(\"IndexedDB error: \" + (event.target as any).errorCode);\n    };\n  \n    // If upgrade needed\n    IDBrequest.onupgradeneeded = function(event) {\n        const db = IDBrequest.result;\n        if (!db.objectStoreNames.contains(\"data\")) {\n            db.createObjectStore(\"data\");\n        }\n    };\n  \n    // If success\n    IDBrequest.onsuccess = function(event) {\n\n        const db = IDBrequest.result;\n  \n        const transaction = db.transaction([\"data\"], \"readwrite\");\n        const objectStore: IDBObjectStore = transaction.objectStore(\"data\");\n        const request = objectStore.add(data, new Date().getTime());\n\n        request.onsuccess = function(event) {\n            console.log(\"Data has been added to your database.\");\n        };\n\n        transaction.oncomplete = function(event) {\n            db.close();\n        };\n        \n    };\n\n  }\n\nfunction getDataFromIndexedDB(DBname:string, DBversion:number, DBstore:string) {\n\n    // Create request to open a indexed database\n    const IDBrequest: IDBRequest = window.indexedDB.open(DBname, DBversion);\n\n    // If error\n    IDBrequest.onerror = function(event) {\n        console.log(\"IndexedDB error: \" + (event.target as any).errorCode);\n    };  \n\n    // If success\n    IDBrequest.onsuccess = function(event) {\n        const db = IDBrequest.result;\n        const transaction = db.transaction([DBstore], \"readwrite\");\n        const objectStore = transaction.objectStore(DBstore);\n        const request = objectStore.getAll();\n        request.onsuccess = function(event) {\n            console.log(\"Data has been added to your database.\");\n        };\n        transaction.oncomplete = function(event) {\n            db.close();\n        };\n    };\n}\n\n\nfunction saveDataToClientDevice(data: any, filename: string) {\n    const blob = new Blob([data], { type: 'text/plain' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.setAttribute('download', filename);\n    a.setAttribute('href', url);\n    a.click();\n}\n\nfunction saveJSONDataToClientDevice(data: any, filename: string) {\n    saveDataToClientDevice(JSON.stringify(data), filename);\n}\n\nfunction convertJSONToCSV(data: any[]): string {\n    if (!Array.isArray(data) || data.length === 0) {\n        return '';\n    }\n\n    // ดึงหัวข้อจาก key ของ object ตัวแรก\n    const headers = Object.keys(data[0]);\n\n    // สร้างแถวของหัวข้อและข้อมูล\n    const rows = data.map((row) =>\n        headers.map((header) => `\"${(row[header] ?? '').toString().replace(/\"/g, '\"\"')}\"`).join(',')\n    );\n\n    // รวม headers และ rows เป็น CSV\n    return [headers.join(','), ...rows].join('\\n');\n}\n\nfunction saveCSVDataToClientDevice(data: any[], filename: string) {\n    // ตรวจสอบและเพิ่มนามสกุล .csv หากไม่มี\n    if (!filename.endsWith('.csv')) {\n        filename += '.csv';\n    }\n\n    // แปลง JSON เป็น CSV\n    const csvContent = convertJSONToCSV(data);\n\n    // สร้าง Blob และดาวน์โหลดไฟล์\n    const blob = new Blob([csvContent], { type: 'text/csv' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.setAttribute('download', filename);\n    a.setAttribute('href', url);\n    a.click();\n}\n\n\nexport {\n    saveCSVDataToClientDevice,\n    convertJSONToCSV,\n    saveDataToLocalStorage,\n    saveDataToIndexedDB,\n    saveDataToClientDevice,\n    saveJSONDataToClientDevice,\n    getDataFromLocalStorage,\n    getDataFromIndexedDB\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}